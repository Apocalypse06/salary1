


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head><title>
	列印薪資帳簿(薪資單)
</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="robots" content="noindex,nofollow" /><meta http-equiv="X-UA-Compatible" content="IE=Edge" /><link type="text/css" rel="stylesheet" href="/ECMain/ECount.Common/Css2/CN/2_base_cn.css?2015070301" /><link type="text/css" rel="stylesheet" href="/ECMain/ECount.Common/Css2/CN/2_layout_cn.css?2017081602" /><link type="text/css" rel="stylesheet" href="/ECMain/ECount.Common/Css2/CN/2_table_cn.css?2016011101" /><link type='text/css' rel='stylesheet'href='/ECMain/ECount.Common/Css2/CN/2_menu_cn.css?v=20150729090357' /><script type="text/javascript" src="https://gc.kis.v2.scr.kaspersky-labs.com/02119A29-BCC2-6347-89F9-AF392F33E65B/main.js" charset="UTF-8"></script><link rel="stylesheet" crossorigin="anonymous" href="https://gc.kis.v2.scr.kaspersky-labs.com/B56E33F293FA-9F98-7436-2CCB-92A91120/abn/main.css"/><span></span><link type="text/css" rel="stylesheet" href="/ECMain/ECount.Common/Css2/CN/2_rpt_print_cn.css?2015070601" /><link type="text/css" rel="stylesheet" href="/ECMain/ECount.Common/Css2/CN/2_etc_cn.css?2017011901" /><link type="text/css" rel="stylesheet" href="/ECMain/ECount.Common/Css2/CN/2_setting_cn.css?2015070301" /><link type='text/css' rel='stylesheet'href='/ECMain/ECount.Common/Css2/dhtmlwindow.css?v=20150313181130' /><span></span><link type='text/css' rel='stylesheet'href='/ECMain/ECount.Common/Css2/tax.css?v=20140918195208' /><span></span><link type='text/css' rel='stylesheet'href='/ECMain/ECount.Common/Css2/ECCalendar.css?v=20150119181649' /><span></span><link type='text/css' rel='stylesheet'href='/ECMain/ECount.Common/Css2/font/font-microsoft-yahei.css?v=20160908120439' /><span></span><link type="text/css" rel="stylesheet" href="/ECMain/ECount.Common/Css2/css2-theme-lightred.css?2016011101" /><script language='javascript' src='/ECMain/Scripts/EC_Global.js?v=20131106191134' type='text/javascript'></script><span></span><script language='javascript' src='/ECMain/Scripts/key_check.js?v=20110321162824' type='text/javascript'></script><span></span><script language='javascript' src='/ECMain/Scripts/dhtmlwindow.js?v=20140410195412' type='text/javascript'></script><span></span><script language='javascript' src='/ECMain/ECount.Common/Javascript/decimal.js?v=20150819090810' type='text/javascript'></script><span></span><script language='javascript' src='/ECMain/ECount.Common/Javascript/ECount.Common.js?v=20180418095228' type='text/javascript'></script><span></span><script language='javascript' src='/ECMain/ECount.Common/Javascript/ECount.Common.Export.js?v=20170613090214' type='text/javascript'></script><span></span><script language='javascript' src='/ECMain/ECount.Common/Javascript/jquery-1.10.2.min.js?v=20131107114958' type='text/javascript'></script><span></span>
 <script language="javascript">     var $jq1102 = jQuery.noConflict(); </script>
 <script language='javascript' src='/ECMain/ECount.Common/Javascript/jquery-1.3.2.min.js?v=20150410091410' type='text/javascript'></script><span></span><script language='javascript' src='/ECMain/ECount.Common/Javascript/jquery.maskedinput-1.2.2.min.js?v=20111124160124' type='text/javascript'></script><span></span><script language='javascript' src='/ECMain/Scripts/PrintHid.js?v=20171108090125' type='text/javascript'></script><span></span><script language='javascript' src='/ECMain/Scripts/Print.js?v=20170622090419' type='text/javascript'></script><span></span><script language='javascript' src='/ECMain/ECount.Common/Javascript/jquery.form.js?v=20120720100832' type='text/javascript'></script><span></span><script language='javascript' src='/ECMain/ECount.Common/Javascript/ECount.Common.Math.js?v=20160104090346' type='text/javascript'></script><span></span><script language='javascript' src='/ECMain/ECount.Common/Javascript/LoadProgressbar.js?v=20171205092626' type='text/javascript'></script><span></span><script language='javascript' src='/ECMain/ECount.Common/Javascript/Util.js?v=20111116102736' type='text/javascript'></script><span></span><script language='javascript' src='/ECMain/ECount.Common/Javascript/jquery.hotkeys-0.7.9.js?v=20131113190706' type='text/javascript'></script><span></span><script language='javascript' src='/ECMain/ECount.Common/Javascript/tableUtil.js?v=20160608092003' type='text/javascript'></script><span></span><script language='javascript' src='/ECMain/ECount.Common/Javascript/jquery.ECImportPopup.js?v=20150309181602' type='text/javascript'></script><span></span><script language='javascript' src='/ECMain/ECount.Common/Javascript/json2.js?v=20120102171930' type='text/javascript'></script><span></span><script language='javascript' src='/ECMain/ECount.Common/Javascript/jquery.EcExtend.js?v=20140626195520' type='text/javascript'></script><span></span>
 <script language="javascript" type="text/javascript" src="/ECMain/ECount.Common/Javascript/ECount.Framework.Bridge.js?2015042401"></script>
 <script language='javascript' src='/ECMain/ECount.Common/Javascript/ECCalendar_New.js?v=20160810094525' type='text/javascript'></script><span></span><script language='javascript' src='/ECMain/ECount.Common/Resource/tw.js?v=20180222113536' type='text/javascript'></script><span></span><script language='javascript' src='/ECERP/Contents/js/jquery.prototype.js?v=20170712120646' type='text/javascript'></script><span></span><script language='javascript' src='/ECERP/Contents/js/jquery.prototype.string.js?v=20171129091220' type='text/javascript'></script><span></span><script language='javascript' src='/ECERP/Contents/js/jquery.prototype.extend.js?v=20180418095215' type='text/javascript'></script><span></span><script language='javascript' src='/ECERP/Contents/js/common/ecmodule.common.eapproval.js?v=20180525094456' type='text/javascript'></script><span></span>
    <script language="javascript" type="text/javascript">
    //<![CDATA[
        // ----------------------------------------------------------------------------------
        // 1. 전역변수 선언 영역
        // ----------------------------------------------------------------------------------
        var iFormCount = 0;

        // ----------------------------------------------------------------------------------
        // 2. 초기 실행 함수 영역
        // ----------------------------------------------------------------------------------


        // ----------------------------------------------------------------------------------
        // 3. 데이터 처리 함수 영역
        // ----------------------------------------------------------------------------------
        //확정여부 체크
        function fnConfirmChk(PaySeq) {
            var flag = true;
            $.ajax({
                type: "POST",
                async: false,
                url: fnSetUrlPath("../EPL/EPL002M_DATA.aspx", "ec_req_sid"),
                data: "Type=PAYCOMFIRM&hidPaySeq=" + PaySeq,
                error: function (errorMsg) {
                    alert(errorMsg);
                },
                success: function (returnXml) {
                    var dom = parseXML(returnXml);
                    var objResultXml = $(dom).find("RESULT");
                    var strCheck = $(dom).find("PAYCOMFIRM").text();

                    if (strCheck == "Y") {
                        alert('已確定處理的薪資明細。<BR />請確認。');
                        flag = false;
                    }
                }
            });
            return flag;
        }

        // ----------------------------------------------------------------------------------
        // 4. 이벤트 호출 함수 영역
        // ----------------------------------------------------------------------------------

        function fnDelete(PaySeq) {
            if (fnConfirmChk(PaySeq)) {  
                if (confirm('資料刪除後不能復原。\n\n真的要刪除嗎？')) {
                    $("#hidSaveType").val("D");
                    $("#hidPaySeq").val(PaySeq);
                    $("#form1")
                    .attr("method", "post")
                    .attr("target", window.name)
                    .attr("action", fnSetUrlPath("EPY001M_SAVE.aspx", "ec_req_sid"))
                    .submit();
                }
                else 
                    return false;
            }
        }
        //이력보기(PSPY_PAYHISTORY_GLOBAL
        function fnHistory(value,title) {
            var vn_screenx = "800";
            var vn_screeny = "460";
            var TitleDes = title+"查詢履歷";
            var pgmUrl = "EPY001P_01";
            var fmObject = $("#frmDetail");
        
            fmObject.get(0)["hidSearchXml2"].value = value;

            objDHtml = dhtmlJPopUp(pgmUrl, fmObject, TitleDes, "", vn_screenx, vn_screeny, "1");
        }
        // 수정
        function fnModify(value) {
            frmSearchData(true);

            if(iFormCount > 0) {
                var Url;
                 if ("1" == "99999") {
                    Url = "/ECMAIN/EPY/EPY002R.aspx";
                } else {
                    Url = "/ECMAIN/EPY/EPY012R.aspx";
                }
            
                $("#hidPaySeq").val(value);
                $("#form1")
                .attr("method", "post")
                .attr("action", fnSetUrlPath(Url, "ec_req_sid"))
                .attr("target", window.name)
                .submit();
            } else {
                alert("沒有權限查看所有格式。\n請聯繫管理員。");
            }
        }
         //양식설정
    function fnPageSetup() {
        var formSer = "";
        if ($("#ddlFormSer").length > 0 && $("#ddlFormSer").attr("disabled") != true && $("#ddlFormSer").val() != "0" && $("#ddlFormSer").val() != "99999" && $("#ddlFormSer").val() != "" )
            formSer = "&FORM_SER=" + $("#ddlFormSer").val();
        fnFormSettingOpen('/ECMain/CM3/CM100P_11.aspx?FORM_GUBUN=PO300'+ formSer , 'CM100P_11', 'y', '800', '800'); 
    }

        //확정처리
        function fnConfirm(strFlag, PaySeq) { 
            $("#hidSaveType").val("confirm");
            $("#hidConfirm").val(strFlag);
            $("#hidPaySeq").val(PaySeq);
            $("#form1")
            .attr("method", "post")
            .attr("target", window.name)
            .attr("action", fnSetUrlPath("EPY001M_SAVE.aspx", "ec_req_sid"))
            .submit();
        }
        // ----------------------------------------------------------------------------------
        // 5. 기능 처리 함수 영역
        // ----------------------------------------------------------------------------------

    //]]>
    </script>
</head>
<body>

    <div id="wrap">
    <!--타이틀-->
        <input type="hidden" name="hidFavSeq" id="hidFavSeq"/>
        <div class="new-title">
        
                <div class="title-leftarea page-bookmark" onclick="javascript:fnFavorityPopupOpen('列印薪資帳簿(薪資單)','E090107','1715','768',''); return false">列印薪資帳簿(薪資單)</div>
             
        <div class="title-rightarea">
                <!-- 검색 -->
                <span class="btn-search" onclick="fnShowSearch(); return false;"></span>
                <!-- 옵션 -->
                <span class="btn-setting" onclick="fnShowOption(); return false;"></span>	
                <!-- 옵션레이어 -->
                <ul class="option_box_new" >
                    <li><a onclick="fnPageSetup();">格式</a></li>
                </ul>
            </div>
        </div> 
        
        
        
        
        
         
        <div class="search-layer">	
            <script src="/ECMain/ECount.Common/Javascript/ECount.Common.Selectbox.Input.js?2016021701" type="text/javascript"></script>
<script language="javascript" type="text/javascript">
//<![CDATA[
    // ----------------------------------------------------------------------------------
    // 1. 전역변수 선언 영역
    // ----------------------------------------------------------------------------------
    var objDHtml;
    var objCode;
    var strCode = "";
    var objName;
    var strName = "";
    
    //오늘 
    var today = new Date("06-03-2018") ;     //오늘날짜
    var yy = today.getFullYear(); //이번연도 
    var ym = today.getMonth() + 1;  //이번달
    var yd = today.getDate();        //오늘일
    var day = today.getDay();      //요일

    // 어제
    var yesterday =new Date(today.valueOf()-(24*60*60*1000));  // 어제 날짜   오늘이 2011.1.1.일이면 어제는 2010.12.31 해당년월이 변경됨
    var yesteryy = yesterday.getFullYear();  //어제연도
    var  yesterym = yesterday.getMonth()+1; //어제월
    var yesteryd = yesterday.getDate();     //어제일
   
    //저번달구하기
    var  lastMonDate = new Date(yy,ym-2,yd);     //1달전 날짜   오늘이 2011.1.1.일이면 1달전  2010.12.1 해당년월이 변경됨
    var lastMonyy = lastMonDate.getFullYear();  //어제연도
    var lastMonym = lastMonDate.getMonth()+1; //어제월
    var lastMonyd = lastMonDate.getDate();     //어제일
 
    //작년
    var lastYearDate = new Date(yy-1, ym-1, yd);
    var lastYearyy = lastYearDate.getFullYear();  //어제연도

    //이번주 일요일 구하기(시작일)  
    var SWeekDate = new Date(yy,ym-1 ,yd- day);  //이번주 시작일  
    var SWeekyy = SWeekDate.getFullYear(); 
    var SWeekym = SWeekDate.getMonth()+1; 
    var SWeekyd = SWeekDate.getDate(); 

    //저번주 일요일(시작일)~토요일(마지막일)
    var LastDate = new Date(yy, ym-1, yd-7);
    var Lastyy =  LastDate.getFullYear();
    var Lastym = LastDate.getMonth(); 
    var Lastyd = LastDate.getDate(); 
    var LastDay = LastDate.getDay(); 

    var SLastDate = new Date(Lastyy , Lastym,Lastyd-LastDay);
    var SLastyy  = SLastDate.getFullYear();
    var SLastym = SLastDate.getMonth()+1;
    var SLastyd = SLastDate.getDate();

    var ELastDate = new Date(Lastyy , Lastym, (6-LastDay)+Lastyd);
    var ELastyy = ELastDate.getFullYear();
    var ELastym = ELastDate.getMonth()+1;
    var ELastyd = ELastDate.getDate();
 
   if(ym<10)
        ym = "0"+ym;
    if(yd<10)
        yd = "0"+yd; 
        
    if(yesterym<10)
        yesterym = "0"+yesterym ;
    if(yesteryd<10)
        yesteryd = "0"+yesteryd ;

    if(lastMonym<10)
        lastMonym = "0"+lastMonym ;
    if(lastMonyd<10)
        lastMonyd = "0"+lastMonyd ;
  
    if(SWeekym<10)
        SWeekym = "0"+SWeekym ;
    if(SWeekyd<10)
        SWeekyd = "0"+SWeekyd ;   

    if(SLastym<10)
        SLastym = "0"+SLastym ;

    if(SLastyd<10)
        SLastyd = "0"+SLastyd ;   

    if(ELastym<10)
        ELastym = "0"+ELastym ;

    if(ELastyd<10)
        ELastyd = "0"+ELastyd ;

    // ----------------------------------------------------------------------------------
    // 2. 초기 실행 함수 영역
    // ----------------------------------------------------------------------------------
    window.onload = function() {
        if($("#ddlFormSer") && $("#ddlFormSer option").length < 1)
            $("#ddlFormSer").attr("disabled", "true");

        SetSearchElementEvent();
                
        
    }    
    // ----------------------------------------------------------------------------------
    // 3. 데이터 처리 함수 영역
    // ----------------------------------------------------------------------------------
    function fnCheck3Years(objStart, objEnd, tabNo) {
        if($("#"+objEnd).length && $("#"+objStart).length && $("#"+objEnd).get(0).value - $("#"+objStart).get(0).value >= 3)
            if(confirm("查詢期間超過三年，查詢速度變慢。\n是否重新設定查詢期間？")) {
                if(tabNo > 0) {
                    MM_showHideLayers1(tabNo);
                    TabChangeFocus();
                }
                $("#"+objStart).focus();
                return true;
            } else
                return false;
    }

    //비동기식으로 데이타를 가져온다.(수당항목)
    function fnGetAllowanceData(strData, Gubun) {
            $.ajax({
                type: "POST",
                dataType: "text",
                async : false,
                url: fnSetUrlPath("/ECMAIN/EPL/EPL002M_DATA.aspx","ec_req_sid"),
                data: strData,
                error: function(errorMsg) {
                    alert("에러발생" + errorMsg);
                    //  return false;
                },
                success: function(returnXml) {
                    var dom = parseXML(returnXml);
                    var objResultXml = $(dom).find("RESULT");
                    var strTypes = $(dom).find("TYPE").text();
                
                    if( Gubun == null || Gubun == "" )
                    {
                        $("#ddlTotalFlag option").remove();
                        var cnt = 1;
                        for(var i = 0; i < objResultXml.length; i++)
                        {
                            $("#ddlTotalFlag").append("<option value='" + objResultXml[i].childNodes[2].firstChild.nodeValue + "|" + objResultXml[i].childNodes[0].firstChild.nodeValue +  "|" + (cnt) + "|" + objResultXml[i].childNodes[3].firstChild.nodeValue + "' >" + objResultXml[i].childNodes[1].firstChild.nodeValue + "</option>");
                    
                            if("" == objResultXml[i].childNodes[2].firstChild.nodeValue + "|" + objResultXml[i].childNodes[0].firstChild.nodeValue+  "|" + (cnt) + "|" + objResultXml[i].childNodes[3].firstChild.nodeValue)
                            {
                                $("#ddlTotalFlag").val(objResultXml[i].childNodes[2].firstChild.nodeValue + "|" + objResultXml[i].childNodes[0].firstChild.nodeValue+  "|" + (cnt) + "|" + objResultXml[i].childNodes[3].firstChild.nodeValue).attr("selected", "selected");
                            }
                            cnt++;
                            if(i < objResultXml.length-1 && objResultXml[i].childNodes[2].firstChild.nodeValue != objResultXml[i+1].childNodes[2].firstChild.nodeValue)
                                cnt = 1;
                        }
                        $("#ddlTotalFlag").append("<option value='PAY||' >支付總額</option>")//지급총액
                        $("#ddlTotalFlag").append("<option value='DEDUCT||' >扣除總額</option>")//공제총액
                        $("#ddlTotalFlag").append("<option value='NET||' >實支付額</option>")//실지급액

                        $("#ddlTotalFlag2 option").remove();
                        var cnt = 1;
                        for(var i = 0; i < objResultXml.length; i++)
                        {
                            if(objResultXml[i].childNodes[2].firstChild.nodeValue == "1" && objResultXml[i].childNodes[3].firstChild.nodeValue != "1") {
                                $("#ddlTotalFlag2").append("<option value='" + objResultXml[i].childNodes[2].firstChild.nodeValue + "|" + objResultXml[i].childNodes[0].firstChild.nodeValue +  "|" + (cnt) + "|" + objResultXml[i].childNodes[3].firstChild.nodeValue + "' >" + objResultXml[i].childNodes[1].firstChild.nodeValue + "</option>");
                        
                                if("" == objResultXml[i].childNodes[2].firstChild.nodeValue + "|" + objResultXml[i].childNodes[0].firstChild.nodeValue+  "|" + (cnt) + "|" + objResultXml[i].childNodes[3].firstChild.nodeValue)
                                {
                                    $("#ddlTotalFlag2").val(objResultXml[i].childNodes[2].firstChild.nodeValue + "|" + objResultXml[i].childNodes[0].firstChild.nodeValue+  "|" + (cnt) + "|" + objResultXml[i].childNodes[3].firstChild.nodeValue).attr("selected", "selected");
                                }
                                cnt++;
                                if(i < objResultXml.length-1 && objResultXml[i].childNodes[2].firstChild.nodeValue != objResultXml[i+1].childNodes[2].firstChild.nodeValue)
                                    cnt = 1;
                            }
                        }
                    }
                    else 
                    {
                        $("#ddlTotalFlag2 option").remove();
                        $("#ddlTotalFlag2").append("<option value=''>全部===</option>");
                        var cnt = 1;
                        for(var i = 0; i < objResultXml.length; i++)
                        {
                            if(objResultXml[i].childNodes[2].firstChild.nodeValue == "1" && objResultXml[i].childNodes[3].firstChild.nodeValue != "1") {
                                $("#ddlTotalFlag2").append("<option value='" + objResultXml[i].childNodes[0].firstChild.nodeValue + "|" + objResultXml[i].childNodes[1].firstChild.nodeValue + "' >" + objResultXml[i].childNodes[1].firstChild.nodeValue + "</option>");
                        
                                if("" == objResultXml[i].childNodes[0].firstChild.nodeValue + "|" + objResultXml[i].childNodes[1].firstChild.nodeValue)
                                {
                                    $("#ddlTotalFlag2").val(objResultXml[i].childNodes[0].firstChild.nodeValue + "|" + objResultXml[i].childNodes[1].firstChild.nodeValue).attr("selected", "selected");
                                }
                                cnt++;
                                if(i < objResultXml.length-1 && objResultXml[i].childNodes[2].firstChild.nodeValue != objResultXml[i+1].childNodes[2].firstChild.nodeValue)
                                    cnt = 1;
                            }
                        }
                    }
                }
            });
    }    

    //비동기식으로 데이타를 가져온다.
    function fnGetData(strData, strSearchUrl, strTitle, strWidth, strHeight, strModal, strDataUrl, strNextF) {
        if (strModal != "Y") {
            $.ajax({
                type: "POST",
                dataType: "text",
                url: strDataUrl != '' ? fnSetUrlPath(strDataUrl,"ec_req_sid") : "",
                data: strData,
                error: function(errorMsg) {
                    alert("에러발생" + errorMsg);
                    //  return false;
                },
                success: function(returnXml) {
                    var dom = parseXML(returnXml);
                    var objResultXml = $(dom).find("RESULT");
                    var strTypes = $(dom).find("TYPE").text();

                    if (objResultXml.length == 1) {
                        //결과 값이 1개일때
                        strName = $(objResultXml).find("NAME").text();
                        strCode = $(objResultXml).find("CODE").text();

                        objName.get(0).value = strName;
                        objCode.get(0).value = strCode;
                    
                        $(strNextF).focus();
                    }
                    else {
                        //검색창 열기
                        objDHtml = dhtmlPopUpOriginal(strSearchUrl + "?" + strData, strTitle, strWidth, strHeight)
                        objNextBox = $(strNextF);
                    }
                }
            });
        }
        else {
            objDHtml = dhtmlPopUpOriginal(strSearchUrl + "?" + strData, strTitle, strWidth, strHeight)
            objNextBox = $(strNextF);
        }
    }

    //비동기식으로 데이타를 가져온다.
    function fnGetData2(strData, strSearchUrl, strTitle, strWidth, strHeight, strModal, strDataUrl, strNextF) {
        if (strModal != "Y")
        {
            $.ajax({
                type: "POST",
                dataType: "text",
                url: fnSetUrlPath(strDataUrl != '' ?strDataUrl:"ESD006M_DATA.aspx","ec_req_sid"),
                data: strData,
                error: function(errorMsg) {
                    alert("發生錯誤\nfnGetData:" + errorMsg);
                    //  return false;
                },
                success: function(returnXml) {
                    var dom = parseXML(returnXml);
                    var objResultXml = $(dom).find("RESULT");
                    var strTypes = $(dom).find("TYPE").text();
                        if (objResultXml.length == 1 && strTypes != "SITEDEPTCM" && strTypes != "SITEPJTCM") {
                            //결과 값이 1개일때
                            if (strModal == "SALE009CM")
                            {
                                strName = $(objResultXml).find("CODE").text();
                                strCode = $(objResultXml).find("NAME").text();
                            }else
                            {
                                strName = $(objResultXml).find("NAME").text();
                                strCode = $(objResultXml).find("CODE").text();
                            }
                            objName.get(0).value = strName;
                            objCode.get(0).value = strCode;
						    if (strModal == "IOTYPE"){							
							    if(strCode == "27" || strCode == "2H" || strCode == "2E") {
                                    if ($("#RadioCard").get(0) != undefined)
									    $("#RadioCard").get(0).style.display = "";
							    }
							    else{
                                    if ($("#RadioCard").get(0) != undefined)
									    $("#RadioCard").get(0).style.display = "none";
								    if($("input:radio[name=rbRptSort]:checked").get(0) != undefined && ($("input:radio[name=rbRptSort]:checked").get(0).value == "5" || $("input:radio[name=rbRptSort]:checked").get(0).value == "6"))
									    $("#rbRptSort").get(0).checked = "0";
									
							    }
						    }
			
                            if (strTypes == "SITEACCCM")
                                objHidVal.get(0).value = $(objResultXml).find("HIDVAL").text();
                            
    //                        if (strTypes == "SEARCH")
    //                        {
    //                            clear_check("4");
    //                        }

                            $(strNextF).focus();
                        }
                        else {
                            // Tree관련 작업 필요 (품목, 거래처, 창고)
                                if (strTypes == "SEARCH") {
                                // 계층그룹 검색의 경우 팝업창 Width값을 조회 처리
                                var iTableWidth = Number($(dom).find("WIDTH").text());
                                var iTablePopWidth = iTableWidth + 260; // Tree 기본 넓이 추가
                                strData = strData + "&LeftW="+String(iTableWidth);
                                
								if(strSearchUrl == "/ECMain/ESA/ESA067M.aspx"){
                                    var winTree = window.open(fnSetUrlPath(strSearchUrl + "?" + strData, "ec_req_sid"), "winTree_SEARCH", "toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=yes,copyhistory=no,width=400,height=400");
                                    winTree.focus();
                                }
                                else {
									var winTree = window.open(fnSetUrlPath(strSearchUrl + "?" + strData,"ec_req_sid"), "winTree_SEARCH", "toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=yes,copyhistory=no,width=" + String(iTablePopWidth) + ",height=560");
									winTree.focus();
								}
                            }
                            else {
                                //검색창 열기
                                objDHtml = dhtmlPopUpOriginal(strSearchUrl + "?" + strData, strTitle, strWidth, strHeight);
                                objNextBox = $(strNextF);
                            }
                        }
                    }
            });
        }
        else
        {
                objDHtml = dhtmlPopUpOriginal(strSearchUrl + "?" + strData, strTitle, strWidth, strHeight);
        }
    }
    // ----------------------------------------------------------------------------------
    // 4. 이벤트 호출 함수 영역
    // ----------------------------------------------------------------------------------
    //코드 검색(부서,사원번호)
    function search_code(gubun, pos, key_gubun, key_type) {
        switch (gubun) {
            case "site": // 부서코드 검색
                objName = $("#txtSiteDes");
                strName = objName.val();
                objCode = $("#txtSiteCd");
                strCode = objCode.val();

                if (key_type != "search") {
                    objCode.val("");
                    objName.val("");
                }

                if (strCode.length > 0 || key_type == "search") {
                    strArgs = "";
                    strArgs += "TYPE=SITE&";
                    if (key_type == "")
                        strArgs += "KeyWord=" + encodeURIComponent(strCode) + "&";
                    else
                        strArgs += "KeyWord=&";
                    strArgs += "DelFlag=N&";
                    strArgs += "ChkFlag=P&";
                    strArgs += "InputFlag=N&";
                    strArgs += "Sort=SITE_DES&";
                    strArgs += "Sort_AD=A&";
                    strArgs += "PageSize=0&";
                    strArgs += "CurrPage=0&";
                    strArgs += "&MergeFlag=Y";
                    var nextfield = "#txtTreeSiteCd";

                    fnGetData(strArgs, "../CM/CM006P.aspx", "查詢部門", "450", "400", 'Y', "", nextfield);
                }
                else {
                    $("#txtTreeSiteCd").focus();
                }

                break;
            case "pjtcd":   //프로젝트 검색
                objName = $("#txtPjtDes");
                objCode = $("#txtPjtCd");
                strCode = objCode.val();
                if (key_type != "search") {
                    objCode.val("");
                    objName.val("");
                }
                if (strCode.length > 0 || key_type == "search") { 
                    if(key_type !="")
                        strCode = "";
                    fnGetData("Type=SITEPJTCM&KeyWord=" + encodeURIComponent(strCode) + "&ChkFlag=P&MergeFlag=Y", "../CM/ES/ES007P.aspx", "查詢專案", "450", "500", "Y", "../CM/ES/ES_CM_DATA.aspx", "#"+fnEnterHandles1(objCode.get(0), event, '2'));
                
                } else {
                    $("#txtEmpDes").focus();
                }
                break;
            case "emp": // 사원번호 검색

                objName = $("#txtEmpDesS");
                strName = objName.val();
                objCode = $("#txtEmpCdS");
                strCode = objCode.val();

                if (key_type != "search") {
                    objCode.val("");
                    objName.val("");
                }

                if (strCode.length > 0 || key_type == "search") {
                    strArgs = "";
                    strArgs += "TYPE=EMPCM&";
                    if (key_type == "")
                        strArgs += "KeyWord=" + encodeURIComponent(strCode) + "&";
                    else
                        strArgs += "KeyWord=&";
                    strArgs += "KeyWordType=5&";
                    strArgs += "INSA=Y&";
                    strArgs += "ChkFlag=L&";
                    strArgs += "MergeFlag=Y&";
                    
                    var nextfield = "#txtEmpName";
                    
                    fnGetData(strArgs, "../CM/EP/EP001P.aspx", GetResource("LBL08390"), "450", "500", 'Y', "", "#"+fnEnterHandles1(objCode.get(0), event, '2'));
                }
                else {
                    $("#txtEmpName").focus();
                }

                break;
        }
    }

    //코드검색2(사원, 부서, 프로젝트, 사업장, 직급, 급여차수)
    function search_code2(Gubun, pos, key_gubun, key_type, th, ev) {
        var objth = $("#" + th).get(0);
        objName = $("#txtColDes" + Gubun);
        objCode = $("#txtColCd" + Gubun);
        
        var strMergeFlag = fn_GetValue();
        var ColGubun = $("#ddlColGubun" + Gubun).get(0);
        var ColCd = $("#txtColCd" + Gubun).get(0).value;
        var ColDes = $("#txtColDes" + Gubun).get(0).value;
        
        if (ColGubun.value == "") {
	        alert("無選擇的查詢準則。\n\n請首選選擇查詢準則。");
	        return;
	    }
	   
	    //사원
	    if (ColGubun.value == "c_EmpCd") {
            strKey = objCode.get(0).value;
            if (objCode.get(0).value!=""||key_type=="double"){
                if( key_type!="double" ){
                    objName.get(0).value = "";
                    objCode.get(0).value = "";
                }else
                    strKey = ""; 
                    //fnGetData(strData, strSearchUrl, strTitle, strWidth, strHeight, strModal, strDataUrl, strNextF)
                    fnGetData("TYPE=EMPCM&KeyWord=" + encodeURIComponent(strKey) + "&KeyWordType=5&MergeFlag=" + strMergeFlag, "../CM/EP/EP001P.aspx", "查詢職員", "450", "500", "Y", ".../CM/EP/EP001P.aspx",  "#"+fnEnterHandles1(objCode.get(0), event, '2'));
            }else{
                objName.get(0).value = "";
                objCode.get(0).value = "";
            }
        }
        //부서
	    else if (ColGubun.value == "c_SiteCd") {
	        if("00" == "00")
	        {
                strKey = objCode.get(0).value;
                if (objCode.get(0).value!=""||key_type=="double"){
                    if( key_type!="double" ){
                        objName.get(0).value = "";
                        objCode.get(0).value = "";
                    }else
                        strKey = "";
                        fnGetData("Type=SITEDEPTCM&KeyWord=" + encodeURIComponent(strKey) + "&KeyWordType=5&ChkFlag=P&MergeFlag=" + strMergeFlag, "../CM/CM006P.aspx", "查詢部門", "450", "500", "SITEDEPTCM", "../CM/ES/ES_CM_DATA.aspx", "#"+fnEnterHandles1(objCode.get(0), event, '2'));
                }else{
                    objName.get(0).value = "";
                    objCode.get(0).value = "";
                }
            }
            else
            {
                objName.get(0).value = "";
                objCode.get(0).value = "";
            }
        }
        //프로젝트
        else if (ColGubun.value == "c_PjtCd") {
            strKey = objCode.get(0).value;
            if (objCode.get(0).value!=""||key_type=="double") {
                if( key_type!="double" ){
                    objName.get(0).value = "";
                    objCode.get(0).value = "";
                }else
                    strKey = ""; 
                fnGetData("Type=SITEPJTCM&KeyWord=" + encodeURIComponent(strCode) + "&ChkFlag=P&MergeFlag="+"Y", "../CM/ES/ES007P.aspx", "查詢專案", "450", "500", "Y", "../CM/ES/ES_CM_DATA.aspx", "#"+fnEnterHandles1(objCode.get(0), event, '2'));
            }else{
                objName.get(0).value = "";
                objCode.get(0).value = "";
            }
        }
        //사업장
	    else if (ColGubun.value == "c_BusinessCd") {
            strKey = objCode.get(0).value;
            if (objCode.get(0).value!=""||key_type=="double"){
                if( key_type!="double" ){
                    objName.get(0).value = "";
                    objCode.get(0).value = "";
                }else
                    strKey = "";
                fnGetData("Type=SUBBUSINESSCM&KeyWord=" + encodeURIComponent(strKey) + "&KeyWordType=5&ChkFlag=L&MergeFlag=" + strMergeFlag, "../CM2/CM301P.aspx", "查詢客戶", "450", "500", "SUBBUSINESSCM", "/ECMAIN/CM2/CM2_DATA.aspx", "#"+fnEnterHandles1(objCode.get(0), event, '2'));
            }else{
                objName.get(0).value = "";
                objCode.get(0).value = "";
            }
        }
        //직급
	    else if (ColGubun.value == "c_PositionCd") {
            strKey = objCode.get(0).value;
            if (objCode.get(0).value!=""||key_type=="double"){
                if( key_type!="double" ){
                    objName.get(0).value = "";
                    objCode.get(0).value = "";
                }else
                    strKey = "";
                    fnGetData("Type=CUSTGROUP&InputFlag=N&CodeClass=I01&KeyWord=" + encodeURIComponent(strKey) + "&MergeFlag=" + strMergeFlag, "../CM/CM002P.aspx", "查詢職級", "450", "500", "", "../CM/ES/ES_CM_DATA.aspx", "#"+fnEnterHandles1(objCode.get(0), event, '2'));
            }else{
                objName.get(0).value = "";
                objCode.get(0).value = "";
            }
        }
        //급여차수
	    else if (ColGubun.value == "c_PayCd") {
            strKey = objCode.get(0).value;
            if (objCode.get(0).value!=""||key_type=="double"){
                if( key_type!="double" ){
                    objName.get(0).value = "";
                    objCode.get(0).value = "";
                }else
                    strKey = "";
                    fnGetData("Type=PAYCD&KeyWord=" + encodeURIComponent(strKey) + "&MergeFlag=" + strMergeFlag,"/ECMAIN/CM2/EP/EP301P.aspx", "薪資次數", "450", "500", "", "/ECMAIN/CM2/CM2_DATA.aspx", "#"+fnEnterHandles1(objCode.get(0), event, '2'));
            }else{
                objName.get(0).value = "";
                objCode.get(0).value = "";
            }
        }
        else if (ColGubun.value.substring(0,1) == "A"){
              strKey = objCode.get(0).value;
            if (objCode.get(0).value!=""||key_type=="double"){
                if( key_type!="double" ){
                    objName.get(0).value = "";
                    objCode.get(0).value = "";
                }else
                    strKey = "";
                    fnGetData("hidAddItemSeq="+ColGubun.value.substring(1)+"&hidSearch="+encodeURIComponent(strKey)+"&objColDes=txtColCd"+Gubun+"&objColCd=txtColDes"+Gubun+"&hidAddDes="+encodeURIComponent(key_gubun)+"&MergeFlag=Y", "/ECMAIN/EPL/EPL002P_06.aspx", key_gubun+"查詢", "450", "500", '', "/ECMAIN/EPL/EPL002M_DATA.aspx", nextfield, "AddCode");	
            }else{
                objName.get(0).value = "";  
                objCode.get(0).value = "";   
            }
        }
        else if (ColGubun.value == "c_PayTypeCd"){
              strKey = objCode.get(0).value;
            if (objCode.get(0).value!=""||key_type=="double"){
                if( key_type!="double" ){
                    objName.get(0).value = "";
                    objCode.get(0).value = "";
                }else
                    strKey = "";
                    fnGetData("Type=PAYCODE&hidSearch="+encodeURIComponent(strKey)+"&objColDes=txtColCd"+Gubun+"&objColCd=txtColDes"+Gubun+"&hidAddDes="+encodeURIComponent(key_gubun)+"&MergeFlag=Y", "/ECMAIN/EPL/EPL002P_09.aspx", key_gubun+"支付類型", "450", "500", '', "/ECMAIN/EPL/EPL002M_DATA.aspx", nextfield, "AddCode");	
            }else{
                objName.get(0).value = "";  
                objCode.get(0).value = "";   
            }
        }
    }

    //코드검색3 계층그룹검색
    function search_code3(gubun,pos,key_gubun,key_type, th, ev) {       
        var objth = $("#"+th).get(0);
        var strparam = "";
        var strMergeFlag = fn_GetValue();
        switch(gubun)
        {
            case 17 :   // 부서계층그룹
                objName = $("#txtTreeSiteNm");
                objCode = $("#txtTreeSiteCd");
                strKey = objCode.get(0).value;
                if (objCode.get(0).value != "" || key_type == "double") {
                    if (sub_prod(strKey) == false) {
                        if (key_type != "double") {
                            objName.get(0).value = "";
                            objCode.get(0).value = "";
                        } else {
                            strKey = "";
                        }
                        fnGetData2("Type=SEARCH&Gubun=PAY&Code=&Text=" + encodeURIComponent(strKey), "/ECMain/ESA/ESA067M.aspx", "選擇群組", "400", "400", "N", "/ECMain/ESA/ESA056M_DATA.aspx", "#"+fnEnterHandles1(objCode.get(0), event, '2'));
                    }
                } else {
                    if (sub_prod(strKey) == false) {
                        objName.get(0).value = "";
                        objCode.get(0).value = "";
                    }
                }  


        }
    }

    // 부서 계층그룹 조회갯수 체크
    function fnSubTreeSiteChange()
    {
        if ($("#cbSubTreeSite").get(0).checked)
        {
            var strValueCode = $("#txtTreeSiteCd").get(0).value;
            if (strValueCode.split('ㆍ').length > 1)
            {
                alert("選取下級組合查詢的情況，僅可選擇1個組合。");
                return false;
            }
        }
    }   

    function Click_F8()
    {
        frmSearchData(true);
    }


    //데이터 검색
    function frmSearchData(year_flag) {
        // 대상년월/지급일자 : 3년 이상 기간 조회, 년도 기준
        if(year_flag) {
            var startYear = "ddlPSYear";
            var endYear = "ddlPEYear";
            if("3" == "5" || "3" == "7" || "3" == "8") {
                startYear = "ddlSYear";
                endYear = "ddlEYear";
            }

            // 3년 이상 기간 조회, 년도 기준
            if(fnCheck3Years(startYear, endYear, 0)) return false;
        }

    
        if ($("#ddlPSYear option:selected").val() + $("#ddlPSMonth option:selected").val() > $("#ddlPEYear option:selected").val() + $("#ddlPEMonth option:selected").val()) {
            alert("The Start date have to set later than End date.");
            $("#ddlPSYear").focus();
            return false;
        }
        
        if($("#ddlRSYear option:selected").val()=="" && $("#ddlRSMonth option:selected").val()=="" && $("#ddlREYear option:selected").val()=="" && $("#ddlREMonth option:selected").val()=="") {}
        else if($("#ddlRSYear option:selected").val()=="" || $("#ddlRSMonth option:selected").val()=="" || $("#ddlREYear option:selected").val()=="" || $("#ddlREMonth option:selected").val()=="")
        {
            alert("正確輸入日期");
            return false;
        }
    
        if ($("#ddlRSYear option:selected").val() + $("#ddlRSMonth option:selected").val() > $("#ddlREYear option:selected").val() + $("#ddlREMonth option:selected").val()) {
            alert("The Start date have to set later than End date.");
            $("#ddlRSYear").focus();
            return false;
        }
        


    
        var strXml = "<root>";
        var str = $("#frmSearch").formToArray();
        for (var i = 0; i < str.length; i++) {
            if (str[i].name != "hidSearchXml") {
                strXml += "<" + str[i].name + "><![CDATA[" + str[i].value + "]]></" + str[i].name + ">";
            }
        }
        if(("3" =="1" || "3" =="4") && strXml.indexOf("ddlPayGCd") < 0)
            strXml += "<ddlPayGCd></ddlPayGCd>";
        if(("3" =="1" || "3" =="4")&& strXml.indexOf("ddlEtcFlag") < 0)
            strXml += "<ddlEtcFlag></ddlEtcFlag>";
        strXml += "<M_RptGubun><![CDATA[3]]></M_RptGubun><M_Page><![CDATA[0]]></M_Page><FirstFlag><![CDATA[N]]></FirstFlag>";
        strXml += "</root>";

        $("#frmSearch").get(0).hidSearchXml.value = strXml;
        
        if ($("#cbSumFlag").is(":checked"))
        {
            if($("#ddlFormSer").get(0).value=="99999"){
                $("#frmSearch")
                .attr("method", "post")
                .attr("action", fnSetUrlPath("/ECMAIN/EPZ/EPZ002R.aspx","ec_req_sid"))
                .submit();        
            }else{
                $("#frmSearch")
                .attr("method", "post")
                .attr("action", fnSetUrlPath("/ECMAIN/EPZ/EPZ012R.aspx","ec_req_sid"))
                .submit(); 
            }
        }
        else
        {
            $("#frmSearch").submit();
        }
        
    }

     function fnEnterHandles1(field, event, gubun) { //gubun 1: next, 2:return nextname        
        var keyCode = event.keyCode ? event.keyCode : event.which ? event.which : event.charCode;
        var next = 0;

        if (keyCode == 13 || gubun == "2") {
            var iField;

            for (iField = 0; iField < field.form.elements.length; iField++) {
                if (field == field.form.elements[iField])
                    break;
            }
            iField = (iField + 1) % field.form.elements.length;

            while (true) {
                if (field.form.elements[iField] != undefined) {

                    tag = field.form.elements[iField].tagName.toLowerCase();
                    if ((field.form.elements[iField].type == "text" || field.form.elements[iField].type == "textarea" || tag == "select" || field.form.elements[iField].type == "checkbox" || field.form.elements[iField].type == "radio"  || field.form.elements[iField].type == "button" ) && field.form.elements[iField].readOnly != true  && field.form.elements[iField].disabled != true && field.form.elements[iField].style.visibility == "" && field.form.elements[iField].style.display != "none") {
                        if (gubun == "1")                    
                            field.form.elements[iField].focus();
                        else
                            return field.form.elements[iField].name;
                        next = 1;
                        break;
                    }
                    else {
                        iField++;
                        continue;
                    }
                }
                else {
                    break;
                }
            }
            return next;
        }
    }

    //DropDownList 값 변환시 체크
    function ReportGubunChk(Gubun, Reset) {
	    var ColGubun = $("#ddlColGubun" + Gubun).get(0).value;
        if(Reset == "Y")
        {
            $("#txtColDes" + Gubun).get(0).value = "";
            $("#txtColCd" + Gubun).get(0).value = "";
            $("#rbCode" + Gubun).attr("checked", "checked")
        }
    
        if(ColGubun  == "c_SGyeCd")
        {
            $("#rbGyeCd" + Gubun).css("visibility", "visible");
            $("#rbGyeCd1" + Gubun).css("visibility", "visible");
        }
        else
        {
            $("#rbGyeCd" + Gubun).css("visibility", "hidden");
            $("#rbGyeCd1" + Gubun).css("visibility", "hidden");
            $("#rbGyeCd" + Gubun).attr("checked", "")
        }
    
	    if ((ColGubun == "c_Day")||(ColGubun == "c_Mon")||(ColGubun == "c_Year")) {
		    if (Gubun == "2"){
			    $("#txtColCd2").get(0).disabled = true;
			    $("#txtColDes2").get(0).disabled = true;
			    $("#txtColCd3").get(0).disabled = true;
			    $("#txtColDes3").get(0).disabled = true;
			    $("#ddlColGubun3").get(0).value = "";
			    $("#ddlColGubun3").get(0).disabled = true;
                $("#txtColCd4").get(0).disabled = true;
			    $("#txtColDes4").get(0).disabled = true;
                $("#ddlColGubun4").get(0).value = "";
			    $("#ddlColGubun4").get(0).disabled = true;
                $("#txtColCd5").get(0).disabled = true;
			    $("#txtColDes5").get(0).disabled = true;
                $("#ddlColGubun5").get(0).value = "";
			    $("#ddlColGubun5").get(0).disabled = true;
		    } else if (Gubun == "3"){
			    $("#txtColCd3").get(0).disabled = true;
			    $("#txtColDes3").get(0).disabled = true;
                $("#txtColCd4").get(0).disabled = true;
			    $("#txtColDes4").get(0).disabled = true;
                $("#ddlColGubun4").get(0).value = "";
			    $("#ddlColGubun4").get(0).disabled = true;
                $("#txtColCd5").get(0).disabled = true;
			    $("#txtColDes5").get(0).disabled = true;
                $("#ddlColGubun5").get(0).value = "";
			    $("#ddlColGubun5").get(0).disabled = true;
              } else if (Gubun == "4"){
                $("#txtColCd4").get(0).disabled = true;
			    $("#txtColDes4").get(0).disabled = true;
                $("#txtColCd5").get(0).disabled = true;
			    $("#txtColDes5").get(0).disabled = true;
                $("#ddlColGubun5").get(0).value = "";
			    $("#ddlColGubun5").get(0).disabled = true;
            }else{
			    $("#txtColCd5").get(0).disabled = true;
			    $("#txtColDes5").get(0).disabled = true;
		    }
	    }else{
                if($("#ddlColGubun2").get(0).value == "c_Mon" || $("#ddlColGubun2").get(0).value == "c_Year"||$("#ddlColGubun3").get(0).value == "c_Mon"||$("#ddlColGubun3").get(0).value == "c_Year"||$("#ddlColGubun4").get(0).value == "c_Mon"||$("#ddlColGubun4").get(0).value == "c_Year" || $("#ddlColGubun5").get(0).value == "c_Mon"||$("#ddlColGubun5").get(0).value == "c_Year")
                {
                    return false;
                }
			    $("#txtColCd2").get(0).disabled = false;
			    $("#txtColDes2").get(0).disabled = false;
			    $("#txtColCd3").get(0).disabled = false;
			    $("#txtColDes3").get(0).disabled = false;
			    $("#ddlColGubun3").get(0).disabled = false;
               $("#txtColCd4").get(0).disabled = false;
			    $("#txtColDes4").get(0).disabled = false;
			    $("#ddlColGubun4").get(0).disabled = false;
                $("#txtColCd5").get(0).disabled = false;
			    $("#txtColDes5").get(0).disabled = false;
			    $("#ddlColGubun5").get(0).disabled = false;
	    }
        chk_change();
    }

    //DropDownList에 따른 체크박스 정의
    function chk_change() {
        if($("#ddlColGubun2").get(0).value != "" || $("#ddlColGubun3").get(0).value != ""|| $("#ddlColGubun4").get(0).value != ""|| $("#ddlColGubun5").get(0).value != "")
        {
            $("#chkCrossGubun").get(0).disabled = false;   
        }
        else
        {
            $("#chkCrossGubun").get(0).disabled = true;
            $("#chkCrossGubun").attr("checked", "")
        }
    
    
        if($("#chkCrossGubun").get(0).checked == true)
        {
            $("#cbRateFlag").get(0).disabled = true;
            $("#cbRateFlag").attr("checked", "")
        }
        else
        {
            $("#cbRateFlag").get(0).disabled = false;
        }
        
        if(($("#ddlColGubun2").get(0).value != "" && $("#chkCrossGubun").get(0).checked == true)  || ($("#ddlColGubun3").get(0).value != "" && $("#chkCrossGubun").get(0).checked == true)|| ($("#ddlColGubun4").get(0).value != "" && $("#chkCrossGubun").get(0).checked == true)|| ($("#ddlColGubun5").get(0).value != "" && $("#chkCrossGubun").get(0).checked == true))
        {
            if($("#rbGubun").attr("checked") ) {
                $("#ddlTotalFlag").get(0).style.visibility = "visible";
                $("#ddlTotalFlag").show();
            }
            else {
                $("#ddlTotalFlag2").get(0).style.visibility = "visible"; 
                $("#ddlTotalFlag2").show();
            }
            
            if($("input:radio[name=rbGubun]:checked").get(0) != undefined && ($("input:radio[name=rbGubun]:checked").get(0).value == "0"))
                $("#frmSearch").get(0).action = fnSetUrlPath("/ECMain/EPY/EPY009R.aspx","ec_req_sid");
            else
                $("#frmSearch").get(0).action = fnSetUrlPath("/ECMain/EPY/EPY011R.aspx","ec_req_sid");
        }
        else
        {
            $("#chkCrossGubun").attr("checked", "")
            if($("#rbGubun").attr("checked") ) {
                $("#ddlTotalFlag").get(0).style.visibility = "hidden";
                $("#ddlTotalFlag").hide();
            }
            else {
                $("#ddlTotalFlag2").get(0).style.visibility = "hidden"; 
                $("#ddlTotalFlag2").hide();
            }

            if($("input:radio[name=rbGubun]:checked").get(0) != undefined && ($("input:radio[name=rbGubun]:checked").get(0).value == "0"))
                $("#frmSearch").get(0).action = fnSetUrlPath("/ECMain/EPY/EPY008R.aspx","ec_req_sid");
            else
                $("#frmSearch").get(0).action = fnSetUrlPath("/ECMain/EPY/EPY010R.aspx","ec_req_sid");
            //$("#frmSearch").get(0).action = "/ECMain/EPY/EPY001M.aspx";
        }
    }

    //간편검색  기준월(귀속년월)  yyyymm
    function fnSimpleSearch(gubun) {
        if(gubun == "Month")
        {
            $("#ddlSYear").get(0).value = yy;
            $("#ddlSMonth").get(0).value = ym;
            $("#txtSDay").get(0).value = "01";
            $("#ddlEYear").get(0).value = yy;
            $("#ddlEMonth").get(0).value = ym;
            $("#txtEDay").get(0).value = "31";
            fnCheckDateValidate('ddlEYear','ddlEMonth','txtEDay');
        }
        else if(gubun == "LastMonth")
        {
            $("#ddlSYear").get(0).value = lastMonyy ;
            $("#ddlSMonth").get(0).value = lastMonym;
            $("#txtSDay").get(0).value = "01";
            $("#ddlEYear").get(0).value = lastMonyy ;
            $("#ddlEMonth").get(0).value = lastMonym ;              
            $("#txtEDay").get(0).value = "31";
            fnCheckDateValidate('ddlEYear','ddlEMonth','txtEDay');       
        }
        else if(gubun == "Year")
        {
            $("#ddlSYear").get(0).value = yy;
            $("#ddlSMonth").get(0).value = "01";
            $("#txtSDay").get(0).value = "01";
            $("#ddlEYear").get(0).value = yy;
            $("#ddlEMonth").get(0).value = "12";
            $("#txtEDay").get(0).value = "31";
            fnCheckDateValidate('ddlEYear','ddlEMonth','txtEDay');
        }
        else if(gubun == "LastYear")
        {
             if (  $("#ddlSYear option").length ==1 ){
                alert(yy - 1+"MSG10142");
                $("#ddlSYear").focus();
                return false;
             }else{ 
                    $("#ddlSYear").get(0).value = yy - 1;
                    $("#ddlSMonth").get(0).value = "01";
                    $("#txtSDay").get(0).value = "01";
                    $("#ddlEYear").get(0).value = yy - 1;
                    $("#ddlEMonth").get(0).value = "12";
                    $("#txtEDay").get(0).value = "31";
                    fnCheckDateValidate('ddlEYear','ddlEMonth','txtEDay');
             }        
        }
        else if(gubun == "EndDay")
        {
            $("#ddlSYear").get(0).value = $("#ddlEYear").get(0).value;
            $("#ddlSMonth").get(0).value = $("#ddlEMonth").get(0).value;
            $("#txtSDay").get(0).value = "01";
            $("#txtEDay").get(0).value = "31";
            fnCheckDateValidate('ddlEYear','ddlEMonth','txtEDay');
        }

        searchit();
    }

    //간편검색 신고귀속  yyyymm
    function fnSimpleSearch2(gubun) {
   
        // 금월
        if(gubun == "Month"){
            $("#ddlPSYear").get(0).value = yy  ;
            $("#ddlPSMonth").get(0).value = ym  ;       
            $("#ddlPEYear").get(0).value = yy  ;
            $("#ddlPEMonth").get(0).value = ym         ;           
        }

        //전월
          if(gubun == "LastMonth"){
            $("#ddlPSYear").get(0).value = lastMonyy ;
            $("#ddlPSMonth").get(0).value = lastMonym;      
            $("#ddlPEYear").get(0).value = lastMonyy ;
            $("#ddlPEMonth").get(0).value = lastMonym ;             
       
          }

        //당년도
         if(gubun == "Year")
         {
            $("#ddlPSYear").get(0).value = yy ;
            $("#ddlPSMonth").get(0).value = "01" ;
         
            $("#ddlPEYear").get(0).value = yy;
            $("#ddlPEMonth").get(0).value = "12";              
       

         }
        //전년도
         if(gubun == "LastYear")
         {    
             if (  $("#ddlPSYear option").length ==1 ){
                  alert(lastYearyy+"MSG10142");
                  $("#ddlPSMonth").focus();
                return false;
             }else{ 
                $("#ddlPSYear").get(0).value = lastYearyy ;
                $("#ddlPSMonth").get(0).value = "01" ; 

                $("#ddlPEYear").get(0).value = lastYearyy;
                $("#ddlPEMonth").get(0).value = "12";    
             } 
         }

        //종료일
        if(gubun == "EndDay")
        {
            $("#ddlPSYear").get(0).value = $("#ddlPEYear").get(0).value;
            $("#ddlPSMonth").get(0).value = $("#ddlPEMonth").get(0).value;
      
        }

           frmSearchData(); 
    }

    //간편검색 기준일자 yyyymmdd
    function fnSimpleSearch3(gubun) { 
    //금일   

        if(gubun=="ToDay"){
            $("#ddlSYear").get(0).value = yy ;
            $("#ddlSMonth").get(0).value = ym ;
            $("#txtSDay").get(0).value = yd ; 

            $("#ddlEYear").get(0).value = yy ;
            $("#ddlEMonth").get(0).value = ym ;               
            $("#txtEDay").get(0).value = yd   ;    
        }

        //전일
         if(gubun=="YesterDay"){
            $("#ddlSYear").get(0).value = yesteryy ;
            $("#ddlSMonth").get(0).value = yesterym ;
            $("#txtSDay").get(0).value = yesteryd ;

            $("#ddlEYear").get(0).value = yesteryy ;
            $("#ddlEMonth").get(0).value = yesterym  ;          
            $("#txtEDay").get(0).value = yesteryd   ;    
         }
          
        //금주
          if(gubun == "Week"){ 
            $("#ddlSYear").get(0).value = SWeekyy ;
            $("#ddlSMonth").get(0).value = SWeekym ;
            $("#txtSDay").get(0).value = SWeekyd ; 
      
            $("#ddlEYear").get(0).value = yy ;
            $("#ddlEMonth").get(0).value = ym ;               
            $("#txtEDay").get(0).value = yd   ;    
          }

        //전주
          if(gubun == "LastWeek"){      
            $("#ddlSYear").get(0).value = SLastyy   ;    
            $("#ddlSMonth").get(0).value = SLastym   ;    
            $("#txtSDay").get(0).value =SLastyd   ;    

            $("#ddlEYear").get(0).value = ELastyy   ;    
            $("#ddlEMonth").get(0).value = ELastym        ;            
            $("#txtEDay").get(0).value   =  ELastyd     ;     
          }

        // 금월
        if(gubun == "Month"){
            $("#ddlSYear").get(0).value = yy  ;
            $("#ddlSMonth").get(0).value = ym  ;
            $("#txtSDay").get(0).value = 1  ;

            $("#ddlEYear").get(0).value = yy  ;
            $("#ddlEMonth").get(0).value = ym         ;       
            $("#txtEDay").get(0).value = yd         ;
        }

        //전월
          if(gubun == "LastMonth"){
            $("#ddlSYear").get(0).value = lastMonyy ;
            $("#ddlSMonth").get(0).value = lastMonym;
            $("#txtSDay").get(0).value = 1;

            $("#ddlEYear").get(0).value = lastMonyy ;
            $("#ddlEMonth").get(0).value = lastMonym ;              
            $("#txtEDay").get(0).value = new Date(lastMonyy, lastMonym,0).getDate();      
          }

        //당년도
         if(gubun == "Year")
         {
            $("#ddlSYear").get(0).value = yy ;
            $("#ddlSMonth").get(0).value = "01" ;
            $("#txtSDay").get(0).value = "1";

            $("#ddlEYear").get(0).value = yy;
            $("#ddlEMonth").get(0).value = "12";              
            $("#txtEDay").get(0).value = "31"     ;  

         }
        //전년도
         if(gubun == "LastYear")
         {
             if (  $("#ddlSYear  option").length ==1 ){
                 alert(lastYearyy+"MSG10142");
             
                  $("#txtSDay").focus();
                return false;
             }else{
                $("#ddlSYear").get(0).value = lastYearyy ;
                $("#ddlSMonth").get(0).value = "01" ;
                $("#txtSDay").get(0).value = "1";

                $("#ddlEYear").get(0).value = lastYearyy;
                $("#ddlEMonth").get(0).value = "12";              
                $("#txtEDay").get(0).value = "31"     ;  
             }       
         }

        //종료일
        if(gubun == "EndDay")
        {
            $("#ddlSYear").get(0).value = $("#ddlEYear").get(0).value;
            $("#ddlSMonth").get(0).value = $("#ddlEMonth").get(0).value;
            $("#txtSDay").get(0).value = $("#txtEDay").get(0).value;
        }

        frmSearchData(); 
    }

    //재직자 퇴직자 체크시 다른거 체크 해제
    function fnchk(obj) {
        if (obj.id == "chkOut") {
            $('[name="chkIn"]').removeAttr('checked');
        }
        else {
            $('[name="chkOut"]').removeAttr('checked');
        }
    }

    //구분 선택시
    function fnGubunChange(id) {
        if(id == "1") {
            $("input[id^=rbSum]").show();            
            $("[id^=lblSum]").show();
            $("#txtSDay").get(0).style.display = "none";
            $("#txtEDay").get(0).style.display = "none";
            $("#btnCallCal_ECDateTime_CM_S").get(0).style.display = "none";
            $("#btnCallCal_ECDateTime_CM_E").get(0).style.display = "none";
            //$("#spTit").get(0).innerText = "薪資合計表";
            $("#tdtext").get(0).innerText = "年月";
            if($("#chkCrossGubun").attr("checked") ) {                
                $("#ddlTotalFlag2").hide();
                $("#ddlTotalFlag").show();
                $("#ddlTotalFlag2").get(0).style.visibility = "hidden";
                $("#ddlTotalFlag").get(0).style.visibility = "visible";
            }
        }
        else {
            $("input[id^=rbSum]").hide();
            $("[id^=lblSum]").hide();
            var cnt = 1;
            $("input[id^=rbSum]").each(function (index) {
                if ($(this).attr("checked")) {
                    $("#rbCode" + cnt).attr("checked", "checked");
                }
                cnt ++;
            });
            $("#txtSDay").get(0).style.display = "";
            $("#txtEDay").get(0).style.display = "";
            $("#btnCallCal_ECDateTime_CM_S").get(0).style.display = "";
            $("#btnCallCal_ECDateTime_CM_E").get(0).style.display = "";
//            $("#spTit").get(0).innerText = "出勤記錄合計表";
            $("#tdtext").get(0).innerText = "日期";
            if($("#chkCrossGubun").attr("checked") ) {
                $("#ddlTotalFlag").hide();
                $("#ddlTotalFlag2").show();
                $("#ddlTotalFlag").get(0).style.visibility = "hidden";
                $("#ddlTotalFlag2").get(0).style.visibility = "visible";
            }
        }
    }

    // ----------------------------------------------------------------------------------
    // 5. 기능 처리 함수 영역
    // ----------------------------------------------------------------------------------
    //객체 이벤트 정의
    function SetSearchElementEvent() {
        /* 부서코드 */
        $("#txtSiteCd")
        .bind("focus", function() {      
            
            FocusColor(this);
            this.select();
        })
        .bind("blur", function() {
            BlurColor2(this);
        })
        .bind("keypress", function() {
            return fnEnterHandles1(this,event,'1');
        })
        .bind("change", function() {
        
        search_code('site', '', '', '');
        
        })
        .bind("dblclick", function() {
        
            search_code('site', '', '', 'search');
        
        });

        
        /* 부서코드-돋보기아이콘 */
            
            $("#imgSearchSiteCd")
            .bind("click", function() {
                search_code('site', '', '', 'search');
            });
            
    
        /* 사원번호 */
        $("#txtEmpCdS")
        .bind("focus", function() {          
            document.onkeydown = function ()
            {
                if( event.keyCode == 13) 
                {
                    $("#txtSiteCd").focus();
                    $("#rbGubun").focus();
                }
            }
        
            FocusColor(this);
            this.select();
        })
        .bind("blur", function() {
            BlurColor2(this);
            document.onkeydown = keyDown;
        })
        .bind("change", function() {
            search_code('emp', '', '', '');
        })
        .bind("dblclick", function() {
            search_code('emp', '', '', 'search');
        });

        /* 사원번호-돋보기아이콘 */
        $("#imgSearchEmpCd")
        .bind("click", function() {
            search_code('emp', '', '', 'search');
        });
    
    
       /*신고귀속시작-년*/
        $("#ddlPSYear")
        .bind("focus", function() {
            nextfield = "ddlPSMonth";
            });
        
       /*신고귀속시작-월*/
        $("#ddlPSMonth")
        .bind("focus", function() {
            nextfield = "ddlPEYear";
            });      
        
        /*신고귀속끝-년*/
        $("#ddlPEYear")
        .bind("focus", function() {
            nextfield = "ddlPEMonth";
            });
        
       /*신고귀속끝-월*/
        $("#ddlPEMonth")
        .bind("focus", function() {
            nextfield = "ddlRSYear";
            });         
    
        /*지급년월시작-년*/
        $("#ddlRSYear")
        .bind("focus", function() {
            nextfield = "ddlRSMonth";
            });
        
       /*지급년월시작-월*/
        $("#ddlRSMonth")
        .bind("focus", function() {
            nextfield = "ddlREYear";
            });      
        
        /*지급년월끝-년*/
        $("#ddlREYear")
        .bind("focus", function() {
            nextfield = "ddlREMonth";
            });
        
       /*지급년월끝-월*/
        $("#ddlREMonth")
        .bind("focus", function() {
            nextfield = "ddlPayGroup";
            }); 
        
        /*차수*/
        $("#ddlPayGroup")
        .bind("focus", function() {
            nextfield = "ddlPayGubun";
        });
        
        /*급여구분*/
        $("#ddlPayGubun")
        .bind("focus", function() {
            
            });                      
    
        /*출력구분-개인별*/
        $("#rbGubun")
        .bind("focus", function() {
            nextfield = "rbGubun2";
            });
        
        /*출력구분-부서별*/
        $("#rbGubun2")
        .bind("focus", function() {
            nextfield = "cbRptConfirm";
            });
        
        /*기타-결재방인쇄*/
        $("#cbRptConfirm")
        .bind("focus", function() {
            nextfield = "cbSumFlag";
            });
        
        /*기타-집계*/
        $("#cbSumFlag")
        .bind("focus", function() {
            nextfield = "save";
        });
    
        if ("3" == "5"||"3" == "6")//급여집계표
        {
            $("#ddlSMonth").focus();
            $("select[id='ddlSYear']").change(
                function() {
                    //$("#ddlEYear").get(0).value = $("#ddlSYear").get(0).value;
                    fnGetAllowanceData("TYPE=ALLOWANCE&KeyWord=" + encodeURIComponent($("#ddlSYear").get(0).value));
                }
            )
        
            fnGetAllowanceData("TYPE=ALLOWANCE&KeyWord=" + encodeURIComponent($("#ddlSYear").get(0).value));
            chk_change();
        }

        if ("3" == "8")
        {
            fnGetAllowanceData("TYPE=ALLOWANCE&KeyWord=" + encodeURIComponent($("#ddlSYear").get(0).value), "8");
        }
    }

    //계층그룹 관련 체크
    function sub_prod(l_prod){
        str_temp = new String(l_prod);
        l_str= str_temp.length;
        for (var i=0; i< l_str; i++) {
            schar = str_temp.charAt(i);
            if (schar == "*" ){			
                return true;
            }
        }
        return false;
    }
    
    //frmSearchData 호출
    function searchit() {
        frmSearchData();
    }

    //화면 따른 구분값 리턴
    function fn_GetValue() {
        var strReVal;
        switch("3")
        {
	        default :
		        strReVal = "Y";
	            break;
        }
        return strReVal;
    }
    // 숫자와 날짜 유효성 체크
    function fnCheckDateValidate(yearCtrl, monthCtrl, dayCtrl)
    {   
        if($("#" + yearCtrl).val() == "" || $("#" + monthCtrl).val() == "00" || $("#" + dayCtrl).val() == "")
        {
            return false;
        }

        if(/[^0123456789]/g.test($("#" + dayCtrl).get(0).value)) 
        {
            alert("正確輸入日期 ");
            $("#" + dayCtrl).get(0).value = "";
            $("#" + dayCtrl).get(0).focus();
        }

        if(Number(checkDate2($("#" + yearCtrl).get(0).value, $("#" + monthCtrl).get(0).value)) < Number($("#" + dayCtrl).get(0).value))
        {
            if (checkDate2($("#" + yearCtrl).get(0).value, $("#" + monthCtrl).get(0).value) == "-1")
            {
                alert("正確輸入日期 ");
                $("#" + dayCtrl).get(0).value = "";
                $("#" + yearCtrl).get(0).focus();
            }    
            else
                $("#" + dayCtrl).get(0).value = checkDate2($("#" + yearCtrl).get(0).value, $("#" + monthCtrl).get(0).value);
        }

        if($("#" + dayCtrl).get(0).value.length > 0)
        {
            if($("#" + dayCtrl).get(0).value.length == 1)
            {
                if ($("#" + dayCtrl).get(0).value == "0") 
                    $("#" + dayCtrl).get(0).value = "01"
                else 
                    $("#" + dayCtrl).get(0).value = "0" + $("#" + dayCtrl).get(0).value                        
            }

            if($("#" + dayCtrl).get(0).value.length == 2 && $("#" + dayCtrl).get(0).value == "00")                                                   
                $("#" + dayCtrl).get(0).value = "01";
        }
    }
    function fnReset()
    {
        $("#frmSearch").get(0).reset();
        return false;
    }

    //구분에 일자별/사원별 클릭시
    function fnDateEmpChange(type) {
        if(type == "E") {
            $("#spFlag2").text('按職員列印');
        } 
        else {
            $("#spFlag2").text('按日期列印');   
        }
    }
//]]>
</script>
<form action="/ECMain/EPY/EPY001M.aspx?ec_req_sid=B-E0KZ2CowJ8YfO" method="post" id="frmSearch" name="frmSearch"  >
    
    <table class="search_t fixed">
        
        <tr>
            <th>年月</th><!--대상년월-->
            <td>
                <span id="ECDateTime_CM_PS"><select name="ddlPSYear" id="ddlPSYear" class="csbYear" ValueSync-ref="basic" datechk-ref="search">
	<option value="2019">2019</option>
	<option selected="selected" value="2018">2018</option>
	<option value="2017">2017</option>
	<option value="2016">2016</option>
	<option value="2015">2015</option>
	<option value="2014">2014</option>
	<option value="2013">2013</option>
	<option value="2012">2012</option>
	<option value="2011">2011</option>
	<option value="2010">2010</option>
	<option value="2009">2009</option>
	<option value="2008">2008</option>
	<option value="2007">2007</option>
	<option value="2006">2006</option>
	<option value="2005">2005</option>
	<option value="2004">2004</option>
	<option value="2003">2003</option>
	<option value="2002">2002</option>
	<option value="2001">2001</option>
	<option value="2000">2000</option>
	<option value="1999">1999</option>
</select><select name="ddlPSMonth" id="ddlPSMonth">
	<option selected="selected" value="01">一月</option>
	<option value="02">二月</option>
	<option value="03">三月</option>
	<option value="04">四月</option>
	<option value="05">五月</option>
	<option value="06">六月</option>
	<option value="07">七月</option>
	<option value="08">八月</option>
	<option value="09">九月</option>
	<option value="10">十月</option>
	<option value="11">十一月</option>
	<option value="12">十二月</option>
</select><input name="txtDay_ECDateTime_CM_PS" type="text" id="txtDay_ECDateTime_CM_PS" maxlength="2" size="2" style="width:20px;display:none;" /></span>
                <img src="/ECMain/ECount.Common/Images/icon_to.gif" width="12px" height="18px" />
                <span id="ECDateTime_CM_PE"><select name="ddlPEYear" id="ddlPEYear" class="csbYear" ValueSync-ref="basic" datechk-ref="search">
	<option value="2019">2019</option>
	<option selected="selected" value="2018">2018</option>
	<option value="2017">2017</option>
	<option value="2016">2016</option>
	<option value="2015">2015</option>
	<option value="2014">2014</option>
	<option value="2013">2013</option>
	<option value="2012">2012</option>
	<option value="2011">2011</option>
	<option value="2010">2010</option>
	<option value="2009">2009</option>
	<option value="2008">2008</option>
	<option value="2007">2007</option>
	<option value="2006">2006</option>
	<option value="2005">2005</option>
	<option value="2004">2004</option>
	<option value="2003">2003</option>
	<option value="2002">2002</option>
	<option value="2001">2001</option>
	<option value="2000">2000</option>
	<option value="1999">1999</option>
</select><select name="ddlPEMonth" id="ddlPEMonth">
	<option value="01">一月</option>
	<option value="02">二月</option>
	<option value="03">三月</option>
	<option value="04">四月</option>
	<option value="05">五月</option>
	<option value="06">六月</option>
	<option value="07">七月</option>
	<option value="08">八月</option>
	<option value="09">九月</option>
	<option value="10">十月</option>
	<option value="11">十一月</option>
	<option selected="selected" value="12">十二月</option>
</select><input name="txtDay_ECDateTime_CM_PE" type="text" id="txtDay_ECDateTime_CM_PE" maxlength="2" size="2" style="width:20px;display:none;" /></span>
            </td>
        </tr>
        
        <tr>
            <th>支付日期</th><!--지급일자-->
            <td>
                <span id="ECDateTime_CM_RS"><select name="ddlRSYear" id="ddlRSYear" onkeypress="fnEnterHandles1(this, event, &#39;1&#39;);" class="csbYear" ValueSync-ref="basic" datechk-ref="search">
	<option value="">====</option>
	<option value="2019">2019</option>
	<option selected="selected" value="2018">2018</option>
	<option value="2017">2017</option>
	<option value="2016">2016</option>
	<option value="2015">2015</option>
	<option value="2014">2014</option>
	<option value="2013">2013</option>
	<option value="2012">2012</option>
	<option value="2011">2011</option>
	<option value="2010">2010</option>
	<option value="2009">2009</option>
	<option value="2008">2008</option>
	<option value="2007">2007</option>
	<option value="2006">2006</option>
	<option value="2005">2005</option>
	<option value="2004">2004</option>
	<option value="2003">2003</option>
	<option value="2002">2002</option>
	<option value="2001">2001</option>
	<option value="2000">2000</option>
	<option value="1999">1999</option>
</select><select name="ddlRSMonth" id="ddlRSMonth" onfocus="nextfield=&#39;txtRSDay&#39;;">
	<option value="">==</option>
	<option selected="selected" value="01">一月</option>
	<option value="02">二月</option>
	<option value="03">三月</option>
	<option value="04">四月</option>
	<option value="05">五月</option>
	<option value="06">六月</option>
	<option value="07">七月</option>
	<option value="08">八月</option>
	<option value="09">九月</option>
	<option value="10">十月</option>
	<option value="11">十一月</option>
	<option value="12">十二月</option>
</select><input name="txtRSDay" type="text" id="txtRSDay" onkeyup="formatNumber(this.value,&#39;0&#39;,this,&#39;&#39;,2,&#39;&#39;);" value="01" maxlength="2" class="default" style="width:20px;" onblur="BlurColor(this);" onkeypress="fnEnterHandles1(this, event, &#39;1&#39;);" onfocus="this.select();" size="2" /><img src='/ECMain/EPY/WebResource.axd?d=7PU6sqRt4oWi_hERdGpoHTES4K5-nQ1H5ux7MhbD4YkeMuOXJpRkeKKcCdaA_3H1T6o-30s_7X4l91wwPk9qQ4qw-_Gbd_L1mhIuusw_vB5fR4cZL2oiYjULxaJQ-GK2dE6faC98JApELeTA7lzwDPXbJ3rxBhfcSL3cut89t29bXdtcLn8XCalqd6SZEb5vWdXwLy_j95l28vjxp_vznVocY_A1&t=636630844242330139' id='btnCallCal_ECDateTime_CM_RS' name='btnCallCal_ECDateTime_CM_RS' style="cursor:pointer;" onclick='ECCalendar_ECDateTime_CM_RS.toggle2("btnCallCal_ECDateTime_CM_RS","N");'/><script type="text/javascript">
var ECCalendar_ECDateTime_CM_RS;
ECCalendar_ECDateTime_CM_RS = new ECCalendar('EcCalendar_ECDateTime_CM_RS', 'popup', document.getElementById('btnCallCal_ECDateTime_CM_RS'), 'ECDateTime_CM_RS', 'ddlRSYear', 'ddlRSMonth', 'txtRSDay', false, 'zh-TW', '1999', '2019', '/ECMain/EPY/WebResource.axd?d=X5hOdRhvxvVUijXPGjy11ChFz1sVsyu6vwkuq_OTHDHte_TDXuYUBlF15yAaSfav01HpJrTMNq-E4uEt9C3QwrnNnuAtRd0C74LkBkgrdTh1sRg2TyQ1B_16Dky9V-viRuxMIinIfM-eWIdCXFXGEX5-3BckStZMdUkYgGc8sKAIdWl8irDLfhSMrITgvRQa22m6umekwIX2imHWXxQaX7P-9bo1&t=636630844242330139', '/ECMain/EPY/WebResource.axd?d=lUH5gyx3viKwZ61ppIG7FoVJNvzSJhIi7yHttrrdtL6JObWkbhVGT230-WvxeTtlUNdfV2KJGDCTfbXpGPBPMocDgZO3xaJk4LTjpJsIM5gF7dXndlO_aSP3w7-lMDzDyUrzckqu4ulnqNav5nMcKbz4KbaoiKSYkstuH6Exyp4kQoEAEV0ZbP5x_0IH1H3eTDiuCn0-WKSUTdCZN85OZeUgdJw1&t=636630844242330139', '/ECMain/EPY/WebResource.axd?d=05_EeC2_D5JYjz_0ZYRNOhA8MGxOhVbn7EqBmR49N6eRwkugBVZv4fbgX9h3PwCXIgThN-E64KPG_MFbZLeHyfEwY38gZ4cFQczptNrQ9Gdmqtm1dd5G8lcEGPSvZWONxDmvI6lX6bDNi28pKasqUz3c8KZ2PHf0Ypa1zg3_bGFL-Zx4FFaWwyfSX82fkuxnTLWzDI0sZJe9rUn8y6efmppN2kw1&t=636630844242330139', '/ECMain/EPY/WebResource.axd?d=3jZmiY6dxhtkKWiBilFYpdItbfNCccHVmle0jJjURpEE58yvnUOtPaUYd2V7N8953PWefx-p6NcK8MU88hA5iXBIqmZxHpAgPCk8aUXryRbl_WgxPKz8pXQce0FByLJG1Zi7kSktrqzJO6e411yUrrtbyI3DeSAj_BhckYz0n4DvehMomXhw24ZxLvywdn8pv134fJPuyAz7tDDQ3rXKtc0C82U1&t=636630844242330139', '/ECMain/EPY/WebResource.axd?d=mpGJ5x1fF1AMz6abRfFz6M82Xp4oIO0ty9190Zp4FMwNyrHnTQCatdk2bDRI2If038hZQIhhAGVGHbRldz2fGq7OndkaPWALMGu9lhdJQnoRw8v8uew-Uo5LMCX4H6rXjSaxnMHqR5lbwZpL0aRK-S88W6u4PF5fRf7C3Tnm4NyxUQlnEu_HX82H6CiaDzBId-uGleZdCporZLwGmMLAE51lKHQ1&t=636630844242330139');
</script>
</span>
                <img src="/ECMain/ECount.Common/Images/icon_to.gif" width="12px" height="18px" />
                <span id="ECDateTime_CM_RE"><select name="ddlREYear" id="ddlREYear" onkeypress="fnEnterHandles1(this, event, &#39;1&#39;);" class="csbYear" ValueSync-ref="basic" datechk-ref="search">
	<option value="">====</option>
	<option value="2019">2019</option>
	<option selected="selected" value="2018">2018</option>
	<option value="2017">2017</option>
	<option value="2016">2016</option>
	<option value="2015">2015</option>
	<option value="2014">2014</option>
	<option value="2013">2013</option>
	<option value="2012">2012</option>
	<option value="2011">2011</option>
	<option value="2010">2010</option>
	<option value="2009">2009</option>
	<option value="2008">2008</option>
	<option value="2007">2007</option>
	<option value="2006">2006</option>
	<option value="2005">2005</option>
	<option value="2004">2004</option>
	<option value="2003">2003</option>
	<option value="2002">2002</option>
	<option value="2001">2001</option>
	<option value="2000">2000</option>
	<option value="1999">1999</option>
</select><select name="ddlREMonth" id="ddlREMonth" onfocus="nextfield=&#39;txtREDay&#39;;">
	<option value="">==</option>
	<option value="01">一月</option>
	<option value="02">二月</option>
	<option value="03">三月</option>
	<option value="04">四月</option>
	<option value="05">五月</option>
	<option value="06">六月</option>
	<option value="07">七月</option>
	<option value="08">八月</option>
	<option value="09">九月</option>
	<option value="10">十月</option>
	<option value="11">十一月</option>
	<option selected="selected" value="12">十二月</option>
</select><input name="txtREDay" type="text" id="txtREDay" onkeyup="formatNumber(this.value,&#39;0&#39;,this,&#39;&#39;,2,&#39;&#39;);" value="30" maxlength="2" class="default" onblur="fnCheckDateValidate(&#39;ddlREYear&#39;,&#39;ddlREMonth&#39;,&#39;txtREDay&#39;);BlurColor(this);" style="width:20px;" onfocus="nextfield=&#39;cbRFlag&#39;;this.select();" size="2" /><img src='/ECMain/EPY/WebResource.axd?d=7PU6sqRt4oWi_hERdGpoHTES4K5-nQ1H5ux7MhbD4YkeMuOXJpRkeKKcCdaA_3H1T6o-30s_7X4l91wwPk9qQ4qw-_Gbd_L1mhIuusw_vB5fR4cZL2oiYjULxaJQ-GK2dE6faC98JApELeTA7lzwDPXbJ3rxBhfcSL3cut89t29bXdtcLn8XCalqd6SZEb5vWdXwLy_j95l28vjxp_vznVocY_A1&t=636630844242330139' id='btnCallCal_ECDateTime_CM_RE' name='btnCallCal_ECDateTime_CM_RE' style="cursor:pointer;" onclick='ECCalendar_ECDateTime_CM_RE.toggle2("btnCallCal_ECDateTime_CM_RE","N");'/><script type="text/javascript">
var ECCalendar_ECDateTime_CM_RE;
ECCalendar_ECDateTime_CM_RE = new ECCalendar('EcCalendar_ECDateTime_CM_RE', 'popup', document.getElementById('btnCallCal_ECDateTime_CM_RE'), 'ECDateTime_CM_RE', 'ddlREYear', 'ddlREMonth', 'txtREDay', false, 'zh-TW', '1999', '2019', '/ECMain/EPY/WebResource.axd?d=X5hOdRhvxvVUijXPGjy11ChFz1sVsyu6vwkuq_OTHDHte_TDXuYUBlF15yAaSfav01HpJrTMNq-E4uEt9C3QwrnNnuAtRd0C74LkBkgrdTh1sRg2TyQ1B_16Dky9V-viRuxMIinIfM-eWIdCXFXGEX5-3BckStZMdUkYgGc8sKAIdWl8irDLfhSMrITgvRQa22m6umekwIX2imHWXxQaX7P-9bo1&t=636630844242330139', '/ECMain/EPY/WebResource.axd?d=lUH5gyx3viKwZ61ppIG7FoVJNvzSJhIi7yHttrrdtL6JObWkbhVGT230-WvxeTtlUNdfV2KJGDCTfbXpGPBPMocDgZO3xaJk4LTjpJsIM5gF7dXndlO_aSP3w7-lMDzDyUrzckqu4ulnqNav5nMcKbz4KbaoiKSYkstuH6Exyp4kQoEAEV0ZbP5x_0IH1H3eTDiuCn0-WKSUTdCZN85OZeUgdJw1&t=636630844242330139', '/ECMain/EPY/WebResource.axd?d=05_EeC2_D5JYjz_0ZYRNOhA8MGxOhVbn7EqBmR49N6eRwkugBVZv4fbgX9h3PwCXIgThN-E64KPG_MFbZLeHyfEwY38gZ4cFQczptNrQ9Gdmqtm1dd5G8lcEGPSvZWONxDmvI6lX6bDNi28pKasqUz3c8KZ2PHf0Ypa1zg3_bGFL-Zx4FFaWwyfSX82fkuxnTLWzDI0sZJe9rUn8y6efmppN2kw1&t=636630844242330139', '/ECMain/EPY/WebResource.axd?d=3jZmiY6dxhtkKWiBilFYpdItbfNCccHVmle0jJjURpEE58yvnUOtPaUYd2V7N8953PWefx-p6NcK8MU88hA5iXBIqmZxHpAgPCk8aUXryRbl_WgxPKz8pXQce0FByLJG1Zi7kSktrqzJO6e411yUrrtbyI3DeSAj_BhckYz0n4DvehMomXhw24ZxLvywdn8pv134fJPuyAz7tDDQ3rXKtc0C82U1&t=636630844242330139', '/ECMain/EPY/WebResource.axd?d=mpGJ5x1fF1AMz6abRfFz6M82Xp4oIO0ty9190Zp4FMwNyrHnTQCatdk2bDRI2If038hZQIhhAGVGHbRldz2fGq7OndkaPWALMGu9lhdJQnoRw8v8uew-Uo5LMCX4H6rXjSaxnMHqR5lbwZpL0aRK-S88W6u4PF5fRf7C3Tnm4NyxUQlnEu_HX82H6CiaDzBId-uGleZdCporZLwGmMLAE51lKHQ1&t=636630844242330139');
</script>
</span>
                    ( <input type="checkbox" name="cbRFlag" id="cbRFlag" value="1" onfocus=""   >應用 )
                </td>
        </tr>
        
        <tr>
            <th>支付類型</th><!--지급대상-->
            <td>
                    <select id="ddlPayGCd1" name="ddlPayGCd1" style="width:120px;" onkeypress="fnEnterHandles1(this,event,'1');">
                    <option value="">全部=====</option>
                    
                            <option value="01" >每月發薪</option>
                    
                            <option value="02" >每日發薪</option>
                    
                    </select>
            </td>
        </tr>
        
        <tr>
            <th>部門</th<!--부서-->
            <td><input id="txtSiteCd" type="text" name="txtSiteCd" class="blue_zoom" value="" style="width:66px;"  /><a href="#"><img src="/ECMain/ECount.Common/Images/Icon_zoom.gif" id="imgSearchSiteCd" width="22px" height="19px" alt="查詢" /></a><input name="txtSiteDes" type="text" id="txtSiteDes" class="graybox" value="" style="width:90px;" readonly /></td>
        </tr>
                
        <tr>
            <th>部門分組組合</th><!--부서계층그룹-->
            <td>
                <input type="text" name="txtTreeSiteCd" id="txtTreeSiteCd" ondblclick="search_code3(17,'','','double','txtTreeSiteCd',event);" onchange="search_code3(17,'','','search','txtTreeSiteCd',event);" onkeypress="return fnEnterHandles1(this,event,'1');" onfocus="FocusColor(this);" onblur="BlurColor2(this); " class="rightnone" value="" style="width:66px;"/><a href="#" onclick="search_code3(17,'','','double','txtTreeSiteCd',event);"><img src="/ECMain/ECount.Common/images/Icon_zoom.gif" width="22px" height="19px" alt="查詢" /></a><input type="text" name="txtTreeSiteNm" id="txtTreeSiteNm" class="grayleft" value="" style="width:90px;" readonly />
                <input type="checkbox" name="cbSubTreeSite" id="cbSubTreeSite" value="1" onclick="return fnSubTreeSiteChange();" onkeypress="return fnEnterHandles1(this,event,'1');"  />包括下級組合查詢
            </td>
        </tr>
        
        <tr> 
            <th>專案</th><!--프로젝트-->
            <td><input type="text" id="txtPjtCd" name="txtPjtCd" style="width:66px"  ondblclick="search_code('pjtcd','','','search');" onchange="search_code('pjtcd','','','');" onkeypress="return fnEnterHandles1(this,event,'1');"  onblur="BlurColor2(this);" class="blue_zoom" value=""  onfocus="FocusColor(this);this.select();" /><a href="#" onclick="search_code('pjtcd','','','search');"><img src="/ECMain/ECount.Common/images/Icon_zoom.gif" width="22px" height="19px" alt="查詢" /></a><input type="text" id="txtPjtDes" name="txtPjtDes" class="graybox" style="width:90px;" value="" readonly />
            </td>
        </tr>
        
        <tr>
            <th>職員</th><!--사원-->
            <td><input id="txtEmpCdS" type="text" name="txtEmpCdS" class="blue_zoom" onkeypress="return fnEnterHandles1(this,event,'1');"  value="" style="width:66px;"/><a href="#"><img src="/ECMain/ECount.Common/Images/Icon_zoom.gif" id="imgSearchEmpCd" width="22px" height="19px" alt="查詢" /></a><input name="txtEmpDesS" type="text" id="txtEmpDesS" class="graybox" value="" style="width:90px;" readonly /></td>
        </tr>
         
        <tr>
                <th>簡便查詢</th>                             
                    
                        <td>  
                            <a href="#" id="Button1" name="btnMonth" class="list_link" onclick="fnSimpleSearch2('Month')" >本月</a>&nbsp;&nbsp;<!--금월--><a href="#" id="Button2" name="btnLastMonth" class="list_link" onclick="fnSimpleSearch2('LastMonth')" >上個月</a>&nbsp;&nbsp;<!--전월--><a href="#" id="Button3" name="btnYear" class="list_link" onclick="fnSimpleSearch2('Year')" >今年</a>&nbsp;&nbsp;<!--당년도--><a href="#" id="Button4" name="btnLastYear" class="list_link" onclick="fnSimpleSearch2('LastYear')" >去年</a>&nbsp;&nbsp;<!--전년도--><a href="#" id="Button5" name="btnEndDay" class="list_link" onclick="fnSimpleSearch2('EndDay')"  >結束月"</a>&nbsp;&nbsp;<!--종료월-->
                        </td>
                     
        </tr>
          
                    

        <input type="hidden" id="hidSearchXml" name="hidSearchXml" />
        <input type="hidden" id="hidSiteCd" name="hidSiteCd" value="" />
        <input type="hidden" id="hidListGubun" name="hidListGubun" value="" />
    </table>    
      
    <div class="search-button">
        <span class="btn blue-inverse"><input onclick="frmSearchData(true);" type="button" id="btnSearch" name="btnSearch"  value="查詢(F8)" /></span>
        
            &nbsp;
            <label class="select_top">
                <select name="ddlFormSer" id="ddlFormSer" >
                    
                        <option  value="2"  >工資帳簿&nbsp;1</option>
                        
                        <option  value="1"  >自訂格式&nbsp;2</option>
                        
                </select>
            </label>
        
    </div>
</form>
            <div class="search-close">
			    <span class="btn-search-close"  onclick="fnShowSearch(); return false"></span>
		    </div>
        </div>

        <form method="post" action="./EPY001M.aspx?ec_req_sid=B-E0KZ2CowJ8YfO" id="form1">
<div class="aspNetHidden">
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUJOTI3ODAyOTQxD2QWAgIJD2QWAmYPDxYGHhBjdXJyZW50UGFnZUluZGV4Zh4QVmlydHVhbEl0ZW1Db3VudAIRHghQYWdlU2l6ZQIaZGRkdRdC7xvol+LSJuC7+THRRmEnhAI=" />
</div>

<div class="aspNetHidden">

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="A862E23A" />
</div>
            <div id="contents">
                <div class="H_15px container">
                    <p class="float_left"><link id="PageingCSS" href="/ECMain/EPY/WebResource.axd?d=1o2dDKa3JnahML7yBtOwbtSUItwk5B0opeMoT6mo9rrrT1bLLESV7oj0gSmFInHeO3LMnBAzTh8w3U57NEmxHJ0tz6jAV3Ro17IdtpTo_PT_4YzcjHdK4OqazcNx0JknzYvXCuBefS-DA-ZjUVfit5wkLgmgwvBcoEnK2ShCZqX5hBjfRH-5d5R4j0ZZs74x8Hbifi_E1Lw6Esndkiy79fx-5Rs1&amp;t=636630844242330139" type="text/css" rel="stylesheet"></link><span id="ECPageing1"><div class="page" style=display:none><p class="img"><img  alt="第一頁"' src="/ECMain/EPY/WebResource.axd?d=0urDsiAirdPOJPHBE9jLTDW43-Oja4D44FmUeypIAd-34vVVVeu_90smiREGqZbwdyb7hxLVw1XK_MWL30Kuagppl7mYqpaLdrvgUcruyo7jlWVzMOLlBHiJhRbeol9a_APC7BuJ4bM_V74rEv_LUohNU1SoqpWgYAKMZRijEolJzlX0pJsLlUxT7lje6PNTyoGag_Omi916P-xgYdkszEQWL8s1&t=636630844242330139" border="0"></p> <p class="img"><img  alt="上一頁" src="/ECMain/EPY/WebResource.axd?d=QdU5sSs_Ws-EENH75HzPK7tLX0OCFz4qojDnwl-cQj6nTZx9n7F6rGdAU84eN6OPtEBqDsLiSQkzD-vDP3VgFHuidpr-S2tF2axs-GnjYOv9-LNehjIEDVvlAYYP3xvAzaFLcfJtWpbEZxzm5U2BDa3Ut8V6ildXtcquE4EiLnC-37IasZsdwpTcbagpQvuxqOm-Mnx2giJ4Zlfy9c44lv8uZmY1&t=636630844242330139" border="0"></p><p><span class="on"> [1] </span>  <p class="img"><img  alt="下一頁" src="/ECMain/EPY/WebResource.axd?d=oQwt0AI42gkwCpL_-L9ZWBpIbp2G3tHVow5Wr8tqPe6_zoCc9Omc8n1tHZ5anR9ikgLiaGbfTYhPAdmB41IfDDQ4ljebcwtxmOpBiiZHktMP1RGuH4NQjEnilS9LyhgNiCEMIJe4b0WU-bzZ5Ri5696l4dItSCsuUWqCsyyrdg9cTigIVSs5HOzcuiQ4D2leacDFTweTRtXZYl-VhqJ_4-5O--E1&t=636630844242330139" border="0"></p> <p class="img"><img  alt="最後一頁" src="/ECMain/EPY/WebResource.axd?d=EZ5BDMQQ5FhF2ppemUkWTeDyvfE2lSIt6muOT4bBpHVqtspxYSiGUWTEdylwE7W3Nc2eY3jMwAYUI1O56b_YGyYyklfCO_iPszzVOXUhossRWL26AxuqY55Rv_cknDADo_jv0rNkk6X6idJwU_5bFqpf62RS1xUIp9CjRf-WHLlcMzE_k2_93w3hrxW-8tS2vQhh28iVolub9bPPouJwidsmAAc1&t=636630844242330139" border="0"></p><p>&nbsp;(p.<select name="ECPageing1$ddlPageing" id="ddlPageing" style="display:none;">
	<option selected="selected" value="1">1</option>

</select><input name="ECPageing1$txtPage" type="text" id="ECPageing1_txtPage" onkeyup="fnPageingGo(this, 1,&#39;ECPageing1$btnSearch&#39;);" onfocus="this.select();nextfield=&#39;done&#39;;" class="default right" style="width:35px;height:13px;margin-bottom:3px;" /> / 1) <input type="submit" name="ECPageing1$btnSearch" value="" onclick="return ($(&#39;#ECPageing1_txtPage&#39;).val()!=&#39;&#39; || $(&#39;#hidPageMovedByKeyboard&#39;).val() == &#39;true&#39;);" id="ECPageing1_btnSearch" class="btn_go" /></p> </div></span></p>
                    
                        <p class="float_right font_s" style="padding-top:12px;">2017/01至今的最近10頁資料。點選[查詢]搜尋以前的資料。</p>
                    
                </div>
                <table class="list fixed H_2px" summary="">
                    <col width="" /><col width="20%" /><col width="20%" /><col width="10%" />
                    <col width="8%" /><col width="7%" /><col width="7%" /><col width="5%" /><col width="7%" />
                    <thead>
                        <tr>
                            <th>薪資帳簿名稱</th>
                            <th>支付類型</th>
                            <th>對象期間</th>
                            <th>支付日期</th>
                            <th>年月</th>
                            <th>人員(名)</th>
                            <th >記錄</th>
                            <th>確定<br />處理</th>
                            <th>刪除</th>
                        </tr>
                    </thead>
                    <tbody>
                    
                            <tr>
                                <td class="left"><a href="#" onclick="javascript:fnModify('29');return false;" class="list_link">2018年5月薪資 (請勿刪除)</a></td>
                                <td>每月發薪</td>
                                <td class="center">2018/05/01 ~ 2018/05/31</td>
                                <td class="center">2018/05/05</td>
                                <td class="center">2018/05</td>
                                <td class="right">0</td>
                                <td class="center"><a href="#" name="btnHistory" id="btnHistory" class="link-blue" onclick="javascript:fnHistory('29','2018年5月薪資 (請勿刪除)');return false;" >記錄</a></td>
                                <td class="center">
                                
                                </td>
                                <td class="center">
                                
                                    <a href="#" name="btnDelete" id="btnDelete" class="link-red" onclick="fnDelete('29');"  />刪除</a>
                                
                                </td>
                            </tr>
                    
                            <tr>
                                <td class="left"><a href="#" onclick="javascript:fnModify('28');return false;" class="list_link">2018年4月薪資 (請勿刪除)</a></td>
                                <td>每月發薪</td>
                                <td class="center">2018/04/01 ~ 2018/04/30</td>
                                <td class="center">2018/05/05</td>
                                <td class="center">2018/04</td>
                                <td class="right">3</td>
                                <td class="center"><a href="#" name="btnHistory" id="btnHistory" class="link-blue" onclick="javascript:fnHistory('28','2018年4月薪資 (請勿刪除)');return false;" >記錄</a></td>
                                <td class="center">
                                
                                        <a href="#" id="btnConfirm" name="btnConfirm" class="link-red" onclick="fnConfirm('N','28');">取消</a>
                                    
                                </td>
                                <td class="center">
                                
                                </td>
                            </tr>
                    
                            <tr>
                                <td class="left"><a href="#" onclick="javascript:fnModify('27');return false;" class="list_link">2018年3月薪資 請勿刪除</a></td>
                                <td>每月發薪</td>
                                <td class="center">2018/03/01 ~ 2018/03/31</td>
                                <td class="center">2018/04/05</td>
                                <td class="center">2018/03</td>
                                <td class="right">3</td>
                                <td class="center"><a href="#" name="btnHistory" id="btnHistory" class="link-blue" onclick="javascript:fnHistory('27','2018年3月薪資 請勿刪除');return false;" >記錄</a></td>
                                <td class="center">
                                
                                        <a href="#" id="btnConfirm" name="btnConfirm" class="link-red" onclick="fnConfirm('N','27');">取消</a>
                                    
                                </td>
                                <td class="center">
                                
                                </td>
                            </tr>
                    
                            <tr>
                                <td class="left"><a href="#" onclick="javascript:fnModify('26');return false;" class="list_link">2018年2月薪資</a></td>
                                <td>每月發薪</td>
                                <td class="center">2018/02/01 ~ 2018/02/28</td>
                                <td class="center">2018/03/05</td>
                                <td class="center">2018/02</td>
                                <td class="right">3</td>
                                <td class="center"><a href="#" name="btnHistory" id="btnHistory" class="link-blue" onclick="javascript:fnHistory('26','2018年2月薪資');return false;" >記錄</a></td>
                                <td class="center">
                                
                                        <a href="#" id="btnConfirm" name="btnConfirm" class="link-red" onclick="fnConfirm('N','26');">取消</a>
                                    
                                </td>
                                <td class="center">
                                
                                </td>
                            </tr>
                    
                            <tr>
                                <td class="left"><a href="#" onclick="javascript:fnModify('25');return false;" class="list_link">2018年1月薪資 (請勿刪除)</a></td>
                                <td>每月發薪</td>
                                <td class="center">2018/01/01 ~ 2018/01/31</td>
                                <td class="center">2018/02/05</td>
                                <td class="center">2018/01</td>
                                <td class="right">3</td>
                                <td class="center"><a href="#" name="btnHistory" id="btnHistory" class="link-blue" onclick="javascript:fnHistory('25','2018年1月薪資 (請勿刪除)');return false;" >記錄</a></td>
                                <td class="center">
                                
                                        <a href="#" id="btnConfirm" name="btnConfirm" class="link-red" onclick="fnConfirm('N','25');">取消</a>
                                    
                                </td>
                                <td class="center">
                                
                                </td>
                            </tr>
                    
                            <tr>
                                <td class="left"><a href="#" onclick="javascript:fnModify('24');return false;" class="list_link">2017年12月薪資</a></td>
                                <td>每月發薪</td>
                                <td class="center">2017/12/01 ~ 2017/12/31</td>
                                <td class="center">2018/01/05</td>
                                <td class="center">2017/12</td>
                                <td class="right">3</td>
                                <td class="center"><a href="#" name="btnHistory" id="btnHistory" class="link-blue" onclick="javascript:fnHistory('24','2017年12月薪資');return false;" >記錄</a></td>
                                <td class="center">
                                
                                        <a href="#" id="btnConfirm" name="btnConfirm" class="link-red" onclick="fnConfirm('N','24');">取消</a>
                                    
                                </td>
                                <td class="center">
                                
                                </td>
                            </tr>
                    
                            <tr>
                                <td class="left"><a href="#" onclick="javascript:fnModify('23');return false;" class="list_link">2017年11月薪資</a></td>
                                <td>每月發薪</td>
                                <td class="center">2017/11/01 ~ 2017/11/30</td>
                                <td class="center">2017/12/05</td>
                                <td class="center">2017/11</td>
                                <td class="right">3</td>
                                <td class="center"><a href="#" name="btnHistory" id="btnHistory" class="link-blue" onclick="javascript:fnHistory('23','2017年11月薪資');return false;" >記錄</a></td>
                                <td class="center">
                                
                                        <a href="#" id="btnConfirm" name="btnConfirm" class="link-red" onclick="fnConfirm('N','23');">取消</a>
                                    
                                </td>
                                <td class="center">
                                
                                </td>
                            </tr>
                    
                            <tr>
                                <td class="left"><a href="#" onclick="javascript:fnModify('22');return false;" class="list_link">2017年10月薪資</a></td>
                                <td>每月發薪</td>
                                <td class="center">2017/10/01 ~ 2017/10/31</td>
                                <td class="center">2017/11/05</td>
                                <td class="center">2017/10</td>
                                <td class="right">3</td>
                                <td class="center"><a href="#" name="btnHistory" id="btnHistory" class="link-blue" onclick="javascript:fnHistory('22','2017年10月薪資');return false;" >記錄</a></td>
                                <td class="center">
                                
                                        <a href="#" id="btnConfirm" name="btnConfirm" class="link-red" onclick="fnConfirm('N','22');">取消</a>
                                    
                                </td>
                                <td class="center">
                                
                                </td>
                            </tr>
                    
                            <tr>
                                <td class="left"><a href="#" onclick="javascript:fnModify('21');return false;" class="list_link">2017年9月薪資</a></td>
                                <td>每月發薪</td>
                                <td class="center">2017/09/01 ~ 2017/09/30</td>
                                <td class="center">2017/10/05</td>
                                <td class="center">2017/09</td>
                                <td class="right">3</td>
                                <td class="center"><a href="#" name="btnHistory" id="btnHistory" class="link-blue" onclick="javascript:fnHistory('21','2017年9月薪資');return false;" >記錄</a></td>
                                <td class="center">
                                
                                        <a href="#" id="btnConfirm" name="btnConfirm" class="link-red" onclick="fnConfirm('N','21');">取消</a>
                                    
                                </td>
                                <td class="center">
                                
                                </td>
                            </tr>
                    
                            <tr>
                                <td class="left"><a href="#" onclick="javascript:fnModify('20');return false;" class="list_link">2017年八月薪資</a></td>
                                <td>每月發薪</td>
                                <td class="center">2017/08/01 ~ 2017/08/31</td>
                                <td class="center">2017/09/05</td>
                                <td class="center">2017/08</td>
                                <td class="right">3</td>
                                <td class="center"><a href="#" name="btnHistory" id="btnHistory" class="link-blue" onclick="javascript:fnHistory('20','2017年八月薪資');return false;" >記錄</a></td>
                                <td class="center">
                                
                                        <a href="#" id="btnConfirm" name="btnConfirm" class="link-red" onclick="fnConfirm('N','20');">取消</a>
                                    
                                </td>
                                <td class="center">
                                
                                </td>
                            </tr>
                    
                            <tr>
                                <td class="left"><a href="#" onclick="javascript:fnModify('18');return false;" class="list_link">2017年7月薪資</a></td>
                                <td>每月發薪</td>
                                <td class="center">2017/07/01 ~ 2017/07/31</td>
                                <td class="center">2017/08/05</td>
                                <td class="center">2017/06</td>
                                <td class="right">3</td>
                                <td class="center"><a href="#" name="btnHistory" id="btnHistory" class="link-blue" onclick="javascript:fnHistory('18','2017年7月薪資');return false;" >記錄</a></td>
                                <td class="center">
                                
                                        <a href="#" id="btnConfirm" name="btnConfirm" class="link-red" onclick="fnConfirm('N','18');">取消</a>
                                    
                                </td>
                                <td class="center">
                                
                                </td>
                            </tr>
                    
                            <tr>
                                <td class="left"><a href="#" onclick="javascript:fnModify('19');return false;" class="list_link">2017年6月薪資</a></td>
                                <td>每月發薪</td>
                                <td class="center">2017/06/01 ~ 2017/06/30</td>
                                <td class="center">2017/07/05</td>
                                <td class="center">2017/06</td>
                                <td class="right">3</td>
                                <td class="center"><a href="#" name="btnHistory" id="btnHistory" class="link-blue" onclick="javascript:fnHistory('19','2017年6月薪資');return false;" >記錄</a></td>
                                <td class="center">
                                
                                        <a href="#" id="btnConfirm" name="btnConfirm" class="link-red" onclick="fnConfirm('N','19');">取消</a>
                                    
                                </td>
                                <td class="center">
                                
                                </td>
                            </tr>
                    
                            <tr>
                                <td class="left"><a href="#" onclick="javascript:fnModify('17');return false;" class="list_link">2017年5月薪資</a></td>
                                <td>每月發薪</td>
                                <td class="center">2017/05/01 ~ 2017/05/31</td>
                                <td class="center">2017/06/05</td>
                                <td class="center">2017/05</td>
                                <td class="right">3</td>
                                <td class="center"><a href="#" name="btnHistory" id="btnHistory" class="link-blue" onclick="javascript:fnHistory('17','2017年5月薪資');return false;" >記錄</a></td>
                                <td class="center">
                                
                                        <a href="#" id="btnConfirm" name="btnConfirm" class="link-red" onclick="fnConfirm('N','17');">取消</a>
                                    
                                </td>
                                <td class="center">
                                
                                </td>
                            </tr>
                    
                            <tr>
                                <td class="left"><a href="#" onclick="javascript:fnModify('16');return false;" class="list_link">2017年4月薪資</a></td>
                                <td>每月發薪</td>
                                <td class="center">2017/04/01 ~ 2017/04/30</td>
                                <td class="center">2017/05/05</td>
                                <td class="center">2017/04</td>
                                <td class="right">3</td>
                                <td class="center"><a href="#" name="btnHistory" id="btnHistory" class="link-blue" onclick="javascript:fnHistory('16','2017年4月薪資');return false;" >記錄</a></td>
                                <td class="center">
                                
                                        <a href="#" id="btnConfirm" name="btnConfirm" class="link-red" onclick="fnConfirm('N','16');">取消</a>
                                    
                                </td>
                                <td class="center">
                                
                                </td>
                            </tr>
                    
                            <tr>
                                <td class="left"><a href="#" onclick="javascript:fnModify('15');return false;" class="list_link">2017年3月薪資</a></td>
                                <td>每月發薪</td>
                                <td class="center">2017/03/01 ~ 2017/03/31</td>
                                <td class="center">2017/04/05</td>
                                <td class="center">2017/03</td>
                                <td class="right">3</td>
                                <td class="center"><a href="#" name="btnHistory" id="btnHistory" class="link-blue" onclick="javascript:fnHistory('15','2017年3月薪資');return false;" >記錄</a></td>
                                <td class="center">
                                
                                        <a href="#" id="btnConfirm" name="btnConfirm" class="link-red" onclick="fnConfirm('N','15');">取消</a>
                                    
                                </td>
                                <td class="center">
                                
                                </td>
                            </tr>
                    
                            <tr>
                                <td class="left"><a href="#" onclick="javascript:fnModify('14');return false;" class="list_link">2017年2月薪資</a></td>
                                <td>每月發薪</td>
                                <td class="center">2017/02/01 ~ 2017/02/28</td>
                                <td class="center">2017/03/05</td>
                                <td class="center">2017/02</td>
                                <td class="right">3</td>
                                <td class="center"><a href="#" name="btnHistory" id="btnHistory" class="link-blue" onclick="javascript:fnHistory('14','2017年2月薪資');return false;" >記錄</a></td>
                                <td class="center">
                                
                                        <a href="#" id="btnConfirm" name="btnConfirm" class="link-red" onclick="fnConfirm('N','14');">取消</a>
                                    
                                </td>
                                <td class="center">
                                
                                </td>
                            </tr>
                    
                            <tr>
                                <td class="left"><a href="#" onclick="javascript:fnModify('13');return false;" class="list_link">2017年1月薪資</a></td>
                                <td>每月發薪</td>
                                <td class="center">2017/01/01 ~ 2017/01/31</td>
                                <td class="center">2017/02/05</td>
                                <td class="center">2017/01</td>
                                <td class="right">3</td>
                                <td class="center"><a href="#" name="btnHistory" id="btnHistory" class="link-blue" onclick="javascript:fnHistory('13','2017年1月薪資');return false;" >記錄</a></td>
                                <td class="center">
                                
                                        <a href="#" id="btnConfirm" name="btnConfirm" class="link-red" onclick="fnConfirm('N','13');">取消</a>
                                    
                                </td>
                                <td class="center">
                                
                                </td>
                            </tr>
                    
                    </tbody>
                </table>
            </div>
            <input type="hidden" name="hidSearchXml" id="hidSearchXml" />
            <input type="hidden" name="hidPaySeq" id="hidPaySeq"  />
            <input type="hidden" id="hidSaveType" name="hidSaveType" />
            <input type="hidden" id="hidConfirm" name="hidConfirm" />
        </form>
        <form id="frmDetail">
            <input name="hidSearchXml2" type="hidden" id="hidSearchXml2" />
        </form>
    </div>
<script type="text/javascript">
iFormCount = 2;
</script>
</body>
</html>
